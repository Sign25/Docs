---
title: "–†–∞–∑–¥–µ–ª 6: Analyzer –∏ Open WebUI"
mode: "wide"
---

**–ü—Ä–æ–µ–∫—Ç:** ADOLF ‚Äî AI-Driven Operations Layer Framework  
**–ú–æ–¥—É–ª—å:** Watcher / Analyzer  
**–í–µ—Ä—Å–∏—è:** 4.3  
**–î–∞—Ç–∞:** –§–µ–≤—Ä–∞–ª—å 2026

---

## 6.1 –û–±–∑–æ—Ä

Analyzer ‚Äî –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ Watcher, —Ä–∞–±–æ—Ç–∞—é—â–∞—è –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ ADOLF. –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –º–æ–¥—É–ª—è Knowledge (Qdrant), –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —á–µ—Ä–µ–∑ Open WebUI.

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Collector (Node.js, VPS), Analyzer –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É ADOLF: FastAPI, PostgreSQL, Celery, Open WebUI.

### –î–≤–∞ —Ä–µ–∂–∏–º–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –¥–∞–Ω–Ω—ã–º

| –†–µ–∂–∏–º | –ì–¥–µ | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|-----|-----------|------------|
| **–î–∞—à–±–æ—Ä–¥** | –ú–æ–¥—É–ª—å Watcher (–ø—É–Ω–∫—Ç –º–µ–Ω—é Open WebUI) | –ë–∞–Ω–Ω–µ—Ä—ã ‚Üí –≥–æ—Ç–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã ‚Üí —Ñ–∏–ª—å—Ç—Ä—ã —É—Ç–æ—á–Ω–µ–Ω–∏—è | –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ |
| **AI-—á–∞—Ç** | –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ Open WebUI (—ç–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è) | –°–≤–æ–±–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–≤ —Ç.—á. –æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞—Ö) |

–î–∞—à–±–æ—Ä–¥ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏ –≤–≤–æ–¥–∞ –¥–ª—è –ò–ò. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –±–∞–Ω–Ω–µ—Ä, –ø–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Ç–æ—á–Ω—è–µ—Ç –≤—ã–±–æ—Ä–∫—É —á–µ—Ä–µ–∑ —Ñ–∏–ª—å—Ç—Ä—ã (–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, –ø–µ—Ä–∏–æ–¥, –∫–∞—Ç–µ–≥–æ—Ä–∏—è).

AI-—á–∞—Ç ‚Äî –µ–¥–∏–Ω—ã–π –¥–ª—è –≤—Å–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ADOLF. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ Open WebUI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –≤–æ–ø—Ä–æ—Å, –∞ LLM –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø –∫ Tools –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (Watcher, Reputation, CFO –∏ –¥—Ä.). –ù–∞–±–æ—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö Tools –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–æ–ª—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ ADOLF Core Middleware. –ú–æ–¥—É–ª—å Watcher —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–≤–æ–∏ Tools –≤ –æ–±—â–µ–º –ø—É–ª–µ.

```mermaid
flowchart TB
    subgraph OWUI["Open WebUI"]
        HOME["–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞<br/>(—ç–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è)"]
        MENU["–ú–µ–Ω—é –º–æ–¥—É–ª–µ–π"]

        HOME --> CHAT["–ï–¥–∏–Ω—ã–π AI-—á–∞—Ç<br/>—Å–≤–æ–±–æ–¥–Ω—ã–π –≤–æ–ø—Ä–æ—Å"]
        CHAT --> MW["Core Middleware<br/>(—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è Tools –ø–æ —Ä–æ–ª–∏)"]
        MW --> TOOLS_ALL["Tools –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π:<br/>Watcher, Reputation,<br/>CFO, Marketing, ..."]

        MENU --> DASH["–ú–æ–¥—É–ª—å Watcher<br/>(–¥–∞—à–±–æ—Ä–¥)"]
        DASH --> BANNERS["–ë–∞–Ω–Ω–µ—Ä—ã<br/>(–≥–æ—Ç–æ–≤—ã–µ –æ—Ç—á—ë—Ç—ã)"]
        BANNERS --> FILTERS["–§–∏–ª—å—Ç—Ä—ã —É—Ç–æ—á–Ω–µ–Ω–∏—è<br/>(–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü,<br/>–ø–µ—Ä–∏–æ–¥, –∫–∞—Ç–µ–≥–æ—Ä–∏—è)"]
        FILTERS --> REPORT["–ü—Ä–µ–¥–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç"]
    end

    subgraph BACKEND["Backend"]
        FAST["FastAPI<br/>Analyzer"]
        CELERY_B["Celery Beat<br/>(–ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)"]
    end

    TOOLS_ALL --> FAST
    REPORT --> FAST
    CELERY_B --> FAST
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart TB
    subgraph VPS["VPS ‚Äî Collector"]
        SQLITE[("SQLite<br/>watcher.db")]
        API_COL["REST API :3002<br/>(—Å–º. –†–∞–∑–¥–µ–ª 5)"]
        KP["Knowledge Pipeline"]
    end

    subgraph MAIN["–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä ‚Äî ADOLF"]
        subgraph ANALYZER["Analyzer"]
            FAST["FastAPI<br/>watcher_analyzer"]
            CELERY_W["Celery Worker"]
            CELERY_B["Celery Beat"]
        end

        subgraph KNOWLEDGE["Knowledge"]
            INPUT["–í—Ö–æ–¥–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è<br/>/data/knowledge/incoming/watcher"]
            ETL["ETL Pipeline"]
            QDRANT[("Qdrant<br/>vector DB")]
        end

        subgraph OWUI["Open WebUI"]
            DASH["–î–∞—à–±–æ—Ä–¥ Watcher<br/>(–±–∞–Ω–Ω–µ—Ä—ã + —Ñ–∏–ª—å—Ç—Ä—ã)"]
            TOOLS["Watcher Tools<br/>(–≤ –æ–±—â–µ–º –ø—É–ª–µ AI-—á–∞—Ç–∞)"]
        end

        CORE_DB[("PostgreSQL<br/>watcher_* —Ç–∞–±–ª–∏—Ü—ã")]
        REDIS[("Redis")]
    end

    KP -->|"Markdown –ø–æ —Å–µ—Ç–∏"| INPUT
    INPUT --> ETL
    ETL --> QDRANT

    QDRANT --> FAST
    FAST --> CORE_DB
    FAST --> CELERY_W
    CELERY_B --> REDIS --> CELERY_W

    DASH --> FAST
    TOOLS --> FAST

    API_COL -.->|"HTTP (—Ä–µ–∑–µ—Ä–≤)"| FAST
```

### –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|--------|
| Knowledge Pipeline (Collector) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Markdown-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Analyzer FastAPI | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| –î–∞—à–±–æ—Ä–¥ (–±–∞–Ω–Ω–µ—Ä—ã) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| AI-—á–∞—Ç (Tools) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Celery-–∑–∞–¥–∞—á–∏ (–ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |

---

## 6.2 Knowledge Pipeline

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

Knowledge Pipeline –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö: Collector (VPS) ‚Üí Knowledge (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä). –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –∏–∑ JSON –≤ Markdown —Å YAML-–∑–∞–≥–æ–ª–æ–≤–∫–æ–º –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –º–æ–¥—É–ª—å Knowledge –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –≤ Qdrant.

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```mermaid
sequenceDiagram
    participant RN as Runner (VPS)
    participant DB as SQLite
    participant KP as Knowledge Pipeline
    participant FS as Network FS
    participant ETL as Knowledge ETL
    participant QD as Qdrant

    RN->>DB: Enrich completed
    RN->>KP: triggerPipeline(sellerId)

    KP->>DB: SELECT product_details WHERE seller_rowid = ?
    KP->>DB: SELECT price_history (last 2 scans for diff)

    KP->>KP: generateMarkdown(seller, products, diff)
    KP->>FS: Write .md to /data/knowledge/incoming/watcher/

    Note over FS: –ü–µ—Ä–µ–¥–∞—á–∞ –ø–æ —Å–µ—Ç–∏<br/>(rsync / NFS / scp)

    ETL->>FS: Watch for new files
    ETL->>QD: Chunk + Embed + Index
```

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

Knowledge Pipeline –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ Collector (—Å–º. [–†–∞–∑–¥–µ–ª 4](/watcher/adolf_watcher_4_scanners_enrichers) –∏ [–†–∞–∑–¥–µ–ª 5](/watcher/adolf_watcher_5_database_api)):

| –ò—Å—Ç–æ—á–Ω–∏–∫ | –§–∞–π–ª / —Ç–∞–±–ª–∏—Ü–∞ | –ö–ª—é—á–µ–≤—ã–µ –ø–æ–ª—è |
|----------|----------------|---------------|
| Scan | `results_seller_<id>.json` | seller\_name, marketplace, total\_products, products\[\] (sku, name, price, old\_price, discount, rating, reviews\_count, badges) |
| Enrich | `enriched_seller_<id>.json` | products\[\] (sku, name, sale\_price, feedbacks, sale\_count, sizes, total\_stock, description, characteristics, images, seller\_name, seller\_ogrn) |
| DB | `price_history` table | sku, price, old\_price, discount, recorded\_at |
| DB | `products` table | –î–≤–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∫–∞–Ω–∞ –¥–ª—è computeDiff() |

### –¢–∏–ø—ã –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

| –¢–∏–ø | –§–∞–π–ª | –¢—Ä–∏–≥–≥–µ—Ä | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ |
|-----|------|---------|------------|
| –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ | `{mp}_seller_{id}_catalog.md` | –ü–æ—Å–ª–µ enrich | –ü–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –≤—Å–µ–º SKU |
| –¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è | `{mp}_seller_{id}_diff.md` | –ü–æ—Å–ª–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ scan | Diff –º–µ–∂–¥—É –¥–≤—É–º—è —Å–∫–∞–Ω–∞–º–∏ |
| –°–≤–æ–¥–∫–∞ –ø–æ –ø—Ä–æ–¥–∞–≤—Ü—É | `{mp}_seller_{id}_summary.md` | –ü–æ—Å–ª–µ scan | –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ |

### –§–æ—Ä–º–∞—Ç Markdown-–¥–æ–∫—É–º–µ–Ω—Ç–∞

#### YAML-–∑–∞–≥–æ–ª–æ–≤–æ–∫

```yaml
---
title: "–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç: Seller Name (Wildberries)"
category: competitive_intelligence
subcategory: enriched_catalog
marketplace: wildberries
seller_id: "1025130"
seller_name: "Seller Name"
enrichment_date: "2026-02-14"
total_products: 142
brand_id: all
access_level: manager
source: watcher_collector
---
```

| –ü–æ–ª–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –≤ RAG |
|------|-----------------|
| `category` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø—É –¥–∞–Ω–Ω—ã—Ö (`competitive_intelligence`) |
| `subcategory` | –£—Ç–æ—á–Ω–µ–Ω–∏–µ: `enriched_catalog`, `price_diff`, `seller_summary` |
| `marketplace` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—É |
| `seller_id` | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ |
| `brand_id` | –†–æ–ª–µ–≤–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (`all` = –¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º –±—Ä–µ–Ω–¥–∞–º) |
| `access_level` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ |

#### –¢–µ–ª–æ: –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥

```markdown
# –ö–∞—Ç–∞–ª–æ–≥: Seller Name (Wildberries)

**–î–∞—Ç–∞ –æ–±–æ–≥–∞—â–µ–Ω–∏—è:** 2026-02-14
**–¢–æ–≤–∞—Ä–æ–≤:** 142
**–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞:** 2 450 ‚ÇΩ
**–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥:** 4.6

## –¢–æ–≤–∞—Ä—ã

### SKU 123456789 ‚Äî –ü–ª–∞—Ç—å–µ –ª–µ—Ç–Ω–µ–µ –º–∏–¥–∏

- **–¶–µ–Ω–∞:** 2 990 ‚ÇΩ (—Å—Ç–∞—Ä–∞—è: 5 980 ‚ÇΩ, —Å–∫–∏–¥–∫–∞ 50%)
- **–†–µ–π—Ç–∏–Ω–≥:** 4.7 (1 284 –æ—Ç–∑—ã–≤–∞, 5 420 –ø—Ä–æ–¥–∞–∂)
- **–ù–∞–ª–∏—á–∏–µ:** 47 —à—Ç (—Ä–∞–∑–º–µ—Ä—ã: 42, 44, 46, 48, 50)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ—ë–≥–∫–æ–µ –ø–ª–∞—Ç—å–µ –∏–∑ –≤–∏—Å–∫–æ–∑—ã...
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:** –°–æ—Å—Ç–∞–≤: –≤–∏—Å–∫–æ–∑–∞ 100%; –¶–≤–µ—Ç: –∫—Ä–∞—Å–Ω—ã–π; –°–µ–∑–æ–Ω: –ª–µ—Ç–æ
- **–ü—Ä–æ–¥–∞–≤–µ—Ü:** –û–û–û –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç (–û–ì–†–ù 1234567890123)
```

#### –¢–µ–ª–æ: —Ü–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–§–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ `computeDiff()` (—Å–º. [–†–∞–∑–¥–µ–ª 3, utils](/watcher/adolf_watcher_3_orchestrator_runner)).

```markdown
# –¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: Seller Name (Wildberries)

**–ü–µ—Ä–∏–æ–¥:** 2026-02-12 ‚Üí 2026-02-14
**–ù–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:** 3
**–£–¥–∞–ª—ë–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤:** 1
**–ò–∑–º–µ–Ω–µ–Ω–∏–π —Ü–µ–Ω:** 12

## –ü–æ–¥–æ—Ä–æ–∂–∞–≤—à–∏–µ (5)

- SKU 123456789 ¬´–ü–ª–∞—Ç—å–µ –ª–µ—Ç–Ω–µ–µ¬ª: 2 500 ‚ÇΩ ‚Üí 2 990 ‚ÇΩ (+19.6%)

## –ü–æ–¥–µ—à–µ–≤–µ–≤—à–∏–µ (7)

- SKU 345678901 ¬´–•—É–¥–∏ –æ–≤–µ—Ä—Å–∞–π–∑¬ª: 4 300 ‚ÇΩ ‚Üí 3 010 ‚ÇΩ (‚àí30.0%)

## –ù–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã (3)

- SKU 456789012 ¬´–Æ–±–∫–∞ –º–∏–¥–∏¬ª ‚Äî 1 890 ‚ÇΩ, —Ä–µ–π—Ç–∏–Ω–≥ 0 (–Ω–æ–≤–∏–Ω–∫–∞)

## –°–Ω—è—Ç—ã–µ —Å –ø—Ä–æ–¥–∞–∂–∏ (1)

- SKU 567890123 ¬´–®–∞–ø–∫–∞ –∑–∏–º–Ω—è—è¬ª ‚Äî –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ 990 ‚ÇΩ
```

### –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤

| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|-------|----------|:---------:|
| rsync –ø–æ SSH | `rsync -az /opt/watcher/knowledge/ user@main:/data/knowledge/incoming/watcher/` | 1 |
| NFS mount | –°–µ—Ç–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, –ø—Ä–∏–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ VPS | 2 |
| scp | –ü—Ä–æ—Å—Ç–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ | 3 |

---

## 6.3 Analyzer: FastAPI-—Å–µ—Ä–≤–∏—Å

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ ADOLF Core

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π FastAPI-—Ä–æ—É—Ç–µ—Ä –¥–ª—è –º–æ–¥—É–ª—è Watcher Analyzer.
# –§–∞–π–ª: /opt/adolf/modules/watcher/router.py
# Prefix: /api/v1/watcher
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: Knowledge (Qdrant), PostgreSQL, Redis
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: —á–µ—Ä–µ–∑ ADOLF Core Middleware (depends=[check_role("manager")])
# –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã: —Å–º. —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∏–∂–µ
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞

–î–∞—à–±–æ—Ä–¥ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —ç—Ç–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã. –ö–∞–∂–¥—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º—ã–π –Ω–∞ –ª–µ—Ç—É –æ—Ç—á—ë—Ç.

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª–∏ | –ë–∞–Ω–Ω–µ—Ä |
|:-----:|------|:----:|--------|
| GET | `/api/v1/watcher/dashboard/alerts` | Manager+ | –ê–ª–µ—Ä—Ç—ã |
| GET | `/api/v1/watcher/dashboard/price-changes` | Manager+ | –¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è |
| GET | `/api/v1/watcher/dashboard/sellers` | Manager+ | –û–±–∑–æ—Ä –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ |
| GET | `/api/v1/watcher/dashboard/seller/{id}/catalog` | Manager+ | –ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥–∞–≤—Ü–∞ |
| GET | `/api/v1/watcher/dashboard/seller/{id}/enriched` | Manager+ | –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |
| GET | `/api/v1/watcher/dashboard/seller/{id}/price-history` | Manager+ | –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω |
| GET | `/api/v1/watcher/dashboard/seller/{id}/diff` | Manager+ | Diff –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∫–∞–Ω–æ–≤ |
| GET | `/api/v1/watcher/dashboard/analytics/pricing` | Manager+ | –¶–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ |
| GET | `/api/v1/watcher/dashboard/analytics/assortment` | Manager+ | –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ |
| GET | `/api/v1/watcher/dashboard/analytics/bestsellers` | Manager+ | –ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ |
| GET | `/api/v1/watcher/dashboard/analytics/compare` | Manager+ | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ |
| GET | `/api/v1/watcher/dashboard/analytics/stock` | Manager+ | –û—Å—Ç–∞—Ç–∫–∏ –∏ —Ä–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏ |
| GET | `/api/v1/watcher/dashboard/system` | Admin | –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã |

–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏: `marketplace`, `seller_id`, `period` (`7d`, `30d`, `90d`), `category`.

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è AI-—á–∞—Ç–∞

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|:-----:|------|:----:|----------|
| GET | `/api/v1/watcher/prices/{sku}` | Manager+ | –î–∞–Ω–Ω—ã–µ –ø–æ SKU (–¥–ª—è Tool) |
| GET | `/api/v1/watcher/prices/{sku}/history` | Manager+ | –¶–µ–Ω–æ–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è (–¥–ª—è Tool) |
| GET | `/api/v1/watcher/compare` | Manager+ | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ (–¥–ª—è Tool) |

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –†–æ–ª–∏ | –û–ø–∏—Å–∞–Ω–∏–µ |
|:-----:|------|:----:|----------|
| PUT | `/api/v1/watcher/alerts/{id}/read` | Manager+ | –ü–æ–º–µ—Ç–∏—Ç—å –∞–ª–µ—Ä—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º |
| GET | `/api/v1/watcher/alerts/settings` | Admin | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä–æ–≥–æ–≤ |
| PUT | `/api/v1/watcher/alerts/settings` | Admin | –û–±–Ω–æ–≤–∏—Ç—å –ø–æ—Ä–æ–≥–∏ |
| GET | `/api/v1/watcher/subscriptions` | Manager+ | –°–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫ |
| POST | `/api/v1/watcher/subscriptions` | Manager+ | –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É |
| DELETE | `/api/v1/watcher/subscriptions/{id}` | Manager+ | –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É |
| GET | `/api/v1/watcher/status` | Admin | –°—Ç–∞—Ç—É—Å Collector (–ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ :3002) |
| POST | `/api/v1/watcher/command` | Admin | –ö–æ–º–∞–Ω–¥–∞ Collector |

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö

```mermaid
flowchart LR
    subgraph PRIMARY["–û—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫"]
        QD[("Qdrant<br/>(Knowledge)")] -->|"RAG-–∑–∞–ø—Ä–æ—Å—ã"| AZ["Analyzer"]
    end

    subgraph FALLBACK["–†–µ–∑–µ—Ä–≤–Ω—ã–π (–ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø)"]
        COL["Collector API<br/>:3002 —á–µ—Ä–µ–∑ VPN"] -.->|"HTTP GET"| AZ
    end

    AZ --> PG[("PostgreSQL<br/>(–∫—ç—à + –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)")]
```

–û—Å–Ω–æ–≤–Ω–æ–π: Qdrant —á–µ—Ä–µ–∑ RAG-–∑–∞–ø—Ä–æ—Å—ã –∫ –º–æ–¥—É–ª—é Knowledge.

–†–µ–∑–µ—Ä–≤–Ω—ã–π: –ø—Ä—è–º–æ–π HTTP –∫ Collector REST API :3002 (—Å–º. [–†–∞–∑–¥–µ–ª 5.5](/watcher/adolf_watcher_5_database_api)). –î–ª—è real-time –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–≥–¥–∞ Knowledge Pipeline –µ—â—ë –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–ª —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ.

---

## 6.4 –î–∞—à–±–æ—Ä–¥ Watcher

–î–∞—à–±–æ—Ä–¥ ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –º–æ–¥—É–ª—è. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ ¬´Watcher¬ª –≤ –º–µ–Ω—é Open WebUI. –ù–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫–∏ –≤–≤–æ–¥–∞ –¥–ª—è –ò–ò.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—à–±–æ—Ä–¥–∞

```mermaid
flowchart TB
    DASH["–î–∞—à–±–æ—Ä–¥ Watcher<br/>(–≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –º–æ–¥—É–ª—è)"]

    DASH --> ROW1["–°—Ç—Ä–æ–∫–∞ 1: –°–≤–æ–¥–∫–∞"]
    DASH --> ROW2["–°—Ç—Ä–æ–∫–∞ 2: –ë–∞–Ω–Ω–µ—Ä—ã –æ—Ç—á—ë—Ç–æ–≤"]
    DASH --> ROW3["–°—Ç—Ä–æ–∫–∞ 3: –ê–Ω–∞–ª–∏—Ç–∏–∫–∞"]
    DASH --> ROW4["–°—Ç—Ä–æ–∫–∞ 4: –°–∏—Å—Ç–µ–º–∞ (Admin)"]

    ROW1 --> S1["–ü—Ä–æ–¥–∞–≤—Ü–æ–≤<br/>–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è: 12"]
    ROW1 --> S2["–¢–æ–≤–∞—Ä–æ–≤<br/>–≤ –±–∞–∑–µ: 15 420"]
    ROW1 --> S3["–ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö<br/>–∞–ª–µ—Ä—Ç–æ–≤: 5"]
    ROW1 --> S4["–ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫–∞–Ω<br/>2 —á–∞—Å–∞ –Ω–∞–∑–∞–¥"]

    ROW2 --> B1["üîî –ê–ª–µ—Ä—Ç—ã"]
    ROW2 --> B2["üìä –¶–µ–Ω–æ–≤—ã–µ<br/>–∏–∑–º–µ–Ω–µ–Ω–∏—è"]
    ROW2 --> B3["üì¶ –ö–∞—Ç–∞–ª–æ–≥–∏<br/>–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"]
    ROW2 --> B4["üîç –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ<br/>–¥–∞–Ω–Ω—ã–µ"]

    ROW3 --> A1["üí∞ –¶–µ–Ω–æ–≤–∞—è<br/>–∞–Ω–∞–ª–∏—Ç–∏–∫–∞"]
    ROW3 --> A2["üìà –ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã<br/>–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"]
    ROW3 --> A3["‚öñÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ<br/>–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤"]
    ROW3 --> A4["üìã –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç<br/>–∏ –æ—Å—Ç–∞—Ç–∫–∏"]

    ROW4 --> SYS1["üñ•Ô∏è –°—Ç–∞—Ç—É—Å<br/>Collector"]
    ROW4 --> SYS2["üìã –û—á–µ—Ä–µ–¥—å<br/>–∑–∞–¥–∞—á"]
```

### –ë–∞–Ω–Ω–µ—Ä—ã –∏ –æ—Ç—á—ë—Ç—ã

–ö–∞–∂–¥—ã–π –±–∞–Ω–Ω–µ—Ä –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –æ—Ç—á—ë—Ç —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

#### –°—Ç—Ä–æ–∫–∞ 1: –°–≤–æ–¥–∫–∞ (—á–∏—Å–ª–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏)

–ß–µ—Ç—ã—Ä–µ –º–µ—Ç—Ä–∏–∫–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

| –ö–∞—Ä—Ç–æ—á–∫–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö | API |
|----------|-----------------|-----|
| –ü—Ä–æ–¥–∞–≤—Ü–æ–≤ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è | `sellers` (status=active) | `/dashboard/sellers` |
| –¢–æ–≤–∞—Ä–æ–≤ –≤ –±–∞–∑–µ | `products` + `product_details` | `/dashboard/sellers` |
| –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤ | `watcher_alerts` (status=unread) | `/dashboard/alerts` |
| –ü–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫–∞–Ω | `scans` (status=completed, MAX created\_at) | `/dashboard/sellers` |

#### –°—Ç—Ä–æ–∫–∞ 2: –ë–∞–Ω–Ω–µ—Ä—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤

| –ë–∞–Ω–Ω–µ—Ä | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ | –§–∏–ª—å—Ç—Ä—ã | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö |
|--------|-------------------|---------|-----------------|
| **–ê–ª–µ—Ä—Ç—ã** | –°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É: —Å–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω, –Ω–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã, –±–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã, –º–∞—Å—Å–æ–≤—ã–π –≤—ã–≤–æ–¥, —Ä–æ—Å—Ç –æ—Ç–∑—ã–≤–æ–≤ | –¢–∏–ø, –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, –ø–µ—Ä–∏–æ–¥ | `watcher_alerts` (PostgreSQL) |
| **–¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** | –ü–æ–¥–æ—Ä–æ–∂–∞–≤—à–∏–µ / –ø–æ–¥–µ—à–µ–≤–µ–≤—à–∏–µ —Ç–æ–≤–∞—Ä—ã, –Ω–æ–≤—ã–µ / —Å–Ω—è—Ç—ã–µ —Å –ø—Ä–æ–¥–∞–∂–∏. –°–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º –ø—Ä–æ–¥–∞–≤—Ü–∞–º | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, –ø–æ—Ä–æ–≥ %, –ø–µ—Ä–∏–æ–¥ | `computeDiff()` ‚Üí `price_diff` –¥–æ–∫—É–º–µ–Ω—Ç—ã (Qdrant) |
| **–ö–∞—Ç–∞–ª–æ–≥–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤** | –í—ã–±–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí —Ç–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤: SKU, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ü–µ–Ω–∞, —Å–∫–∏–¥–∫–∞, —Ä–µ–π—Ç–∏–Ω–≥, –æ—Ç–∑—ã–≤—ã, –±–µ–π–¥–∂–∏ | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (—Ü–µ–Ω–∞, —Ä–µ–π—Ç–∏–Ω–≥, –æ—Ç–∑—ã–≤—ã) | `products` (SQLite) ‚Üí Qdrant |
| **–û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ** | –í—ã–±–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí –¥–µ—Ç–∞–ª–∏: –æ–ø–∏—Å–∞–Ω–∏–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Å–æ—Å—Ç–∞–≤, —Ä–∞–∑–º–µ—Ä—ã, –æ—Å—Ç–∞—Ç–∫–∏, —Ñ–æ—Ç–æ, –û–ì–†–ù | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, SKU | `product_details` (SQLite) ‚Üí Qdrant |

#### –°—Ç—Ä–æ–∫–∞ 3: –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã

| –ë–∞–Ω–Ω–µ—Ä | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ | –§–∏–ª—å—Ç—Ä—ã | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö |
|--------|-------------------|---------|-----------------|
| **–¶–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | –°—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã –∏ —Å–∫–∏–¥–∫–∏ –ø–æ –ø—Ä–æ–¥–∞–≤—Ü–∞–º, —á–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ü–µ–Ω–æ–≤—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø–µ—Ä–∏–æ–¥ | `price_history` + `product_details` (–∞–≥—Ä–µ–≥–∞—Ü–∏—è) |
| **–ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤** | –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É, –æ—Ç–∑—ã–≤–∞–º –∏ –ø—Ä–æ–¥–∞–∂–∞–º. ABC-–∞–Ω–∞–ª–∏–∑ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, —Ç–æ–ø N | `product_details` (sale\_count, feedbacks, rating) |
| **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤** | –¢–∞–±–ª–∏—Ü–∞: –ø—Ä–æ–¥–∞–≤–µ—Ü √ó –º–µ—Ç—Ä–∏–∫–∞ (–∫–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤, —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞, —Å—Ä–µ–¥–Ω—è—è —Å–∫–∏–¥–∫–∞, —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥, –≥–ª—É–±–∏–Ω–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞) | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –≤—ã–±–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ | `sellers` + `products` + `product_details` (–∞–≥—Ä–µ–≥–∞—Ü–∏—è) |
| **–ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç –∏ –æ—Å—Ç–∞—Ç–∫–∏** | –†–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏, –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ —Å–∫–ª–∞–¥–∞–º, —Ç–æ–≤–∞—Ä—ã —Å –Ω–∏–∑–∫–∏–º —Å—Ç–æ–∫–æ–º, —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ (new/removed –∑–∞ –ø–µ—Ä–∏–æ–¥) | –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, –ø–æ—Ä–æ–≥ –æ—Å—Ç–∞—Ç–∫–∞ | `product_details` (sizes, total\_stock) + `computeDiff()` |

#### –°—Ç—Ä–æ–∫–∞ 4: –°–∏—Å—Ç–µ–º–∞ (—Ç–æ–ª—å–∫–æ Admin)

| –ë–∞–Ω–Ω–µ—Ä | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö |
|--------|-------------------|-----------------|
| **–°—Ç–∞—Ç—É—Å Collector** | –ü–ö: –æ–Ω–ª–∞–π–Ω/–æ—Ñ—Ñ–ª–∞–π–Ω/–∑–∞–Ω—è—Ç, –∑–∞–¥–∞—á–∏: running/queued, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: —Å–∫–∞–Ω–æ–≤, —Ç–æ–≤–∞—Ä–æ–≤, –æ–±–æ–≥–∞—â–µ–Ω–∏–π | CDP Pool `/summary` + Collector `/stats` + `/tasks` |
| **–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á** | –¢–µ–∫—É—â–∏–µ –∏ –æ–∂–∏–¥–∞—é—â–∏–µ –∑–∞–¥–∞—á–∏ (scan + enrich), –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã, –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è | Collector `/tasks` |

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```mermaid
flowchart TB
    DASH["–î–∞—à–±–æ—Ä–¥"] -->|"–∫–ª–∏–∫ –±–∞–Ω–Ω–µ—Ä"| LIST["–°–ø–∏—Å–æ–∫ / —Ç–∞–±–ª–∏—Ü–∞<br/>(–æ—Ç—á—ë—Ç –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è)"]
    LIST -->|"—Ñ–∏–ª—å—Ç—Ä—ã"| FILTERED["–û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫"]
    FILTERED -->|"–∫–ª–∏–∫ –Ω–∞ —Å—Ç—Ä–æ–∫—É"| DETAIL["–î–µ—Ç–∞–ª—å–Ω—ã–π –≤–∏–¥<br/>(–ø—Ä–æ–¥–∞–≤–µ—Ü / —Ç–æ–≤–∞—Ä / –∞–ª–µ—Ä—Ç)"]
    DETAIL -->|"–Ω–∞–∑–∞–¥"| LIST

    LIST -->|"–≤—ã–±–æ—Ä –ø—Ä–æ–¥–∞–≤—Ü–∞"| SELLER["–ü—Ä–æ—Ñ–∏–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞:<br/>‚Äî –∫–∞—Ç–∞–ª–æ–≥<br/>‚Äî –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ<br/>‚Äî —Ü–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è<br/>‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω"]
```

–ü—Ä–∏–º–µ—Ä —Ü–µ–ø–æ—á–∫–∏: –î–∞—à–±–æ—Ä–¥ ‚Üí ¬´–¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è¬ª ‚Üí —Ñ–∏–ª—å—Ç—Ä ¬´Wildberries¬ª ‚Üí —Ñ–∏–ª—å—Ç—Ä ¬´–ü–æ–¥–µ—à–µ–≤–µ–≤—à–∏–µ &gt; 20%¬ª ‚Üí –∫–ª–∏–∫ –Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí –ø—Ä–æ—Ñ–∏–ª—å –ø—Ä–æ–¥–∞–≤—Ü–∞ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π.

### –ö–∞—Ä—Ç–æ—á–∫–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞

–ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–¥–∞–≤—Ü–∞ (–∏–∑ –ª—é–±–æ–≥–æ –±–∞–Ω–Ω–µ—Ä–∞) –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ—Ñ–∏–ª—å —Å —Ç–∞–±–∞–º–∏:

| –¢–∞–± | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ | API |
|-----|------------|-----|
| –ö–∞—Ç–∞–ª–æ–≥ | –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–∫–∞–Ω–∞ | `/dashboard/seller/{id}/catalog` |
| –î–µ—Ç–∞–ª–∏ | –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –æ–ø–∏—Å–∞–Ω–∏—è, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, —Ñ–æ—Ç–æ | `/dashboard/seller/{id}/enriched` |
| –¶–µ–Ω—ã | –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –ø–æ SKU (—Ç–∞–±–ª–∏—Ü–∞ / –≥—Ä–∞—Ñ–∏–∫) | `/dashboard/seller/{id}/price-history` |
| –ò–∑–º–µ–Ω–µ–Ω–∏—è | Diff –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–≤—É—Ö —Å–∫–∞–Ω–æ–≤ | `/dashboard/seller/{id}/diff` |
| –ò–Ω—Ñ–æ | –ò–º—è, –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫–∞–Ω | `/dashboard/sellers` |

---

## 6.5 Watcher Tools (AI-—á–∞—Ç)

Watcher —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç —Å–≤–æ–∏ Tools –≤ –æ–±—â–µ–º –ø—É–ª–µ ADOLF. –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ Open WebUI –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–¥–∞—ë—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –≤–æ–ø—Ä–æ—Å ‚Äî LLM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π Tool –∏–∑ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ Tool –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–æ–ª—å—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ ADOLF Core Middleware.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```mermaid
flowchart TB
    USER["–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å<br/>(–≥–ª–∞–≤–Ω–∞—è Open WebUI)"] -->|"—Å–≤–æ–±–æ–¥–Ω—ã–π –≤–æ–ø—Ä–æ—Å"| LLM["LLM<br/>(GPT-5 mini)"]
    LLM --> MW["Core Middleware<br/>(–ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏)"]
    MW -->|"tool_call"| WT["Watcher Tools"]
    MW -->|"tool_call"| RT["Reputation Tools"]
    MW -->|"tool_call"| OT["... –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏"]
    WT -->|"HTTP"| FAST["FastAPI Analyzer"]
    FAST --> RESP["–û—Ç–≤–µ—Ç –≤ —á–∞—Ç–µ"]
```

### Watcher Tools

| Tool | –û–ø–∏—Å–∞–Ω–∏–µ | –†–æ–ª–∏ |
|------|----------|:----:|
| `watcher_get_prices` | –¢–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –ø–æ SKU | Manager+ |
| `watcher_price_history` | –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω –∑–∞ –ø–µ—Ä–∏–æ–¥ | Manager+ |
| `watcher_compare_competitors` | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω–æ–≤–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è | Manager+ |
| `watcher_get_alerts` | –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã | Manager+ |
| `watcher_add_subscription` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | Manager+ |
| `watcher_list_subscriptions` | –°–ø–∏—Å–æ–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ | Manager+ |
| `watcher_mark_alert_read` | –ü–æ–º–µ—Ç–∏—Ç—å –∞–ª–µ—Ä—Ç –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–º | Manager+ |
| `watcher_agent_status` | –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã Collector | Admin |
| `watcher_agent_command` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Collector | Admin |
| `watcher_settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ –∏ –ø–æ—Ä–æ–≥–æ–≤ | Admin |

### –ü—Ä–∏–º–µ—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

| –ó–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | Tool | –û—Ç–≤–µ—Ç |
|---------------------|------|-------|
| ¬´–ö–∞–∫–∞—è —Ü–µ–Ω–∞ –Ω–∞ –∞—Ä—Ç–∏–∫—É–ª 12345?¬ª | watcher\_get\_prices | –¢–∞–±–ª–∏—Ü–∞ —Ü–µ–Ω –ø–æ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞–º |
| ¬´–ö–∞–∫ –º–µ–Ω—è–ª–∞—Å—å —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ 12345 –∑–∞ –º–µ—Å—è—Ü?¬ª | watcher\_price\_history | –¢–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π + —Å–≤–æ–¥–∫–∞ |
| ¬´–°—Ä–∞–≤–Ω–∏ —Ü–µ–Ω—ã Seller A –∏ Seller B¬ª | watcher\_compare\_competitors | –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ + AI-–∞–Ω–∞–ª–∏–∑ |
| ¬´–ß—Ç–æ –Ω–æ–≤–æ–≥–æ —É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤?¬ª | watcher\_get\_alerts | –°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤ |
| ¬´–î–æ–±–∞–≤—å –ø—Ä–æ–¥–∞–≤—Ü–∞ 1025130 —Å WB¬ª | watcher\_add\_subscription | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è |
| ¬´–°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∞¬ª | watcher\_agent\_status | –û—Ç—á—ë—Ç –æ Collector |

### –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è Claude Code (Tools)

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Open WebUI Tool: watcher_get_prices
# –§–∞–π–ª: /opt/adolf/tools/watcher_get_prices.py
#
# –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è LLM:
#   "–ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–Ω –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ –ø–æ SKU.
#    –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ —Ü–µ–Ω–∞—Ö –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤,
#    —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞—Ö, –∏–ª–∏ –ø—Ä–æ—Å–∏—Ç —Å—Ä–∞–≤–Ω–∏—Ç—å —Ü–µ–Ω—ã."
#
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
#   sku: str ‚Äî –∞—Ä—Ç–∏–∫—É–ª —Ç–æ–≤–∞—Ä–∞
#   marketplace: Optional[str] ‚Äî —Ñ–∏–ª—å—Ç—Ä –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞
#
# –õ–æ–≥–∏–∫–∞:
#   1. –ó–∞–ø—Ä–æ—Å –∫ Analyzer API: GET /api/v1/watcher/prices/{sku}
#   2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞ –≤ Markdown-—Ç–∞–±–ª–∏—Ü—É
#   3. –ï—Å–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∫—Ä–∞—Ç–∫—É—é —Å–≤–æ–¥–∫—É –¥–∏–Ω–∞–º–∏–∫–∏
```

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Open WebUI Tool: watcher_compare_competitors
# –§–∞–π–ª: /opt/adolf/tools/watcher_compare_competitors.py
#
# –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è LLM:
#   "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω–æ–≤–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤."
#
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
#   seller_ids: List[str] ‚Äî ID –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
#   marketplace: Optional[str]
#
# –õ–æ–≥–∏–∫–∞:
#   1. RAG-–∑–∞–ø—Ä–æ—Å –∫ Knowledge
#   2. Fallback –∫ Collector API (GET /api/v1/sellers/:id/enriched)
#   3. –ê–≥—Ä–µ–≥–∞—Ü–∏—è: —Å—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã, —Å–∫–∏–¥–∫–∏, –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç
#   4. AI-–∞–Ω–∞–ª–∏–∑ (GPT-5 mini): –≤—ã—è–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
```

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Open WebUI Tool: watcher_agent_status
# –§–∞–π–ª: /opt/adolf/tools/watcher_agent_status.py
#
# –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è LLM:
#   "–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö Watcher Collector.
#    –¢–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤."
#
# –õ–æ–≥–∏–∫–∞:
#   1. HTTP GET –∫ Collector API: /api/v1/pool/summary
#   2. HTTP GET –∫ Collector API: /api/v1/tasks
#   3. HTTP GET –∫ Collector API: /api/v1/stats
#   4. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —á–∏—Ç–∞–µ–º—ã–π –æ—Ç—á—ë—Ç
#
# Collector API: —Å–º. –†–∞–∑–¥–µ–ª 5.5
```

---

## 6.6 Celery-–∑–∞–¥–∞—á–∏

### –ü—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤

Celery Beat –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç—ã –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –¥–∞—à–±–æ—Ä–¥ –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ PostgreSQL (`watcher_analytics_cache`).

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –ß—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç |
|--------|:----------:|----------------|
| `watcher.pregenerate_alerts` | –ö–∞–∂–¥—ã–π —á–∞—Å | –°–ø–∏—Å–æ–∫ –∞–ª–µ—Ä—Ç–æ–≤ –∏–∑ —Å–≤–µ–∂–∏—Ö –¥–∞–Ω–Ω—ã—Ö |
| `watcher.pregenerate_pricing` | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | –¶–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (—Å—Ä–µ–¥–Ω–∏–µ, –¥–∏–∞–ø–∞–∑–æ–Ω—ã, —á–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π) |
| `watcher.pregenerate_bestsellers` | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | –¢–æ–ø —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ sale\_count, feedbacks, rating |
| `watcher.pregenerate_comparison` | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ |
| `watcher.pregenerate_assortment` | –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤ | –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –æ—Å—Ç–∞—Ç–∫–∏, —Ä–∞–∑–º–µ—Ä–Ω—ã–µ —Å–µ—Ç–∫–∏ |

### –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ (–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ)

| –ó–∞–¥–∞—á–∞ | –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|:----------:|----------|
| `watcher.sync_knowledge` | –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ Knowledge, –∑–∞–ø—É—Å–∫ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ |
| `watcher.cleanup_alerts` | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 03:00 | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö –∞–ª–µ—Ä—Ç–æ–≤ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π |
| `watcher.cleanup_cache` | –ï–∂–µ–¥–Ω–µ–≤–Ω–æ 04:00 | –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏–∑ `watcher_analytics_cache` |
| `watcher.collector_health` | –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Collector API (:3002) |

### –ó–∞–¥–∞—á–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É

| –ó–∞–¥–∞—á–∞ | –¢—Ä–∏–≥–≥–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|---------|----------|
| `watcher.analyze_seller` | AI-—á–∞—Ç Tool | –ì–ª—É–±–æ–∫–∏–π AI-–∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞ (Claude Opus 4.5) |
| `watcher.export_data` | AI-—á–∞—Ç Tool (Senior+) | –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ XLSX |
| `watcher.forward_command` | AI-—á–∞—Ç Tool (Admin) | –ü–µ—Ä–µ–¥–∞—á–∞ –∫–æ–º–∞–Ω–¥—ã Collector API |

---

## 6.7 –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥–µ–ª–∏

### –¶–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö | AI-–º–æ–¥–µ–ª—å |
|---------|-----------------|-----------|
| –î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω –ø–æ SKU | `price_diff` –¥–æ–∫—É–º–µ–Ω—Ç—ã | –ë–µ–∑ AI (—Ä–∞—Å—á—ë—Ç) |
| –°—Ä–µ–¥–Ω—è—è —Å–∫–∏–¥–∫–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ | `enriched_catalog` –¥–æ–∫—É–º–µ–Ω—Ç—ã | –ë–µ–∑ AI (—Ä–∞—Å—á—ë—Ç) |
| –ß–∞—Å—Ç–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω | `price_diff` –∑–∞ –ø–µ—Ä–∏–æ–¥ | –ë–µ–∑ AI (—Ä–∞—Å—á—ë—Ç) |
| –¶–µ–Ω–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ | –í—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø—Ä–æ–¥–∞–≤—Ü–∞ | GPT-5 mini |
| –¶–µ–Ω–æ–≤–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ö–∞—Ç–∞–ª–æ–≥–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ | GPT-5 mini |

### –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö | AI-–º–æ–¥–µ–ª—å |
|---------|-----------------|-----------|
| –°–∫–æ—Ä–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | `price_diff` (new/removed) | –ë–µ–∑ AI |
| –ì–ª—É–±–∏–Ω–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ | `enriched_catalog` | –ë–µ–∑ AI |
| –ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã –∏ –∞—É—Ç—Å–∞–π–¥–µ—Ä—ã | `enriched_catalog` (rating, reviews) | –ë–µ–∑ AI |
| ABC-–∞–Ω–∞–ª–∏–∑ | `enriched_catalog` (sale\_count, feedbacks) | –ë–µ–∑ AI |
| –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å –Ω–∞—à–∏–º –∫–∞—Ç–∞–ª–æ–≥–æ–º | Knowledge (watcher + own products) | GPT-5 mini |

### –ê–ª–µ—Ä—Ç—ã

| –ê–ª–µ—Ä—Ç | –£—Å–ª–æ–≤–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) | –ü–∞—Ä–∞–º–µ—Ç—Ä |
|-------|------------------------|----------|
| –†–µ–∑–∫–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã | price\_change &lt; ‚àí15% | `alert_price_drop_pct` |
| –†–µ–∑–∫–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ —Ü–µ–Ω—ã | price\_change &gt; +20% | `alert_price_rise_pct` |
| –ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | new\_product –≤ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ | `alert_categories[]` |
| –ë–µ–π–¥–∂ ¬´–ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä¬ª | badge = '–ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä' (–Ω–æ–≤—ã–π) | ‚Äî |
| –ú–∞—Å—Å–æ–≤—ã–π –≤—ã–≤–æ–¥ | removed &gt; 10% –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ –∑–∞ –¥–µ–Ω—å | `alert_mass_removal_pct` |
| –†–æ—Å—Ç –æ—Ç–∑—ã–≤–æ–≤ | reviews\_count delta &gt; +50 –∑–∞ —Å—É—Ç–∫–∏ | `alert_review_surge` |

---

## 6.8 –°—Ö–µ–º–∞ PostgreSQL (Analyzer)

```sql
-- –ê–ª–µ—Ä—Ç—ã
CREATE TABLE watcher_alerts (
    id SERIAL PRIMARY KEY,
    type VARCHAR(50) NOT NULL,
    severity VARCHAR(20) DEFAULT 'info',
    marketplace VARCHAR(30),
    seller_id VARCHAR(50),
    seller_name VARCHAR(200),
    sku VARCHAR(50),
    product_name VARCHAR(500),
    message TEXT NOT NULL,
    data JSONB,
    status VARCHAR(20) DEFAULT 'unread',
    created_at TIMESTAMPTZ DEFAULT NOW(),
    read_at TIMESTAMPTZ,
    read_by INTEGER REFERENCES users(id)
);

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤
CREATE TABLE watcher_alert_settings (
    id SERIAL PRIMARY KEY,
    key VARCHAR(100) UNIQUE NOT NULL,
    value JSONB NOT NULL,
    updated_at TIMESTAMPTZ DEFAULT NOW(),
    updated_by INTEGER REFERENCES users(id)
);

-- –ü–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
CREATE TABLE watcher_subscriptions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id),
    marketplace VARCHAR(30) NOT NULL,
    seller_id VARCHAR(50) NOT NULL,
    seller_name VARCHAR(200),
    notify_price_change BOOLEAN DEFAULT TRUE,
    notify_new_products BOOLEAN DEFAULT TRUE,
    notify_badges BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    UNIQUE(user_id, marketplace, seller_id)
);

-- –ö—ç—à –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ –¥–ª—è –¥–∞—à–±–æ—Ä–¥–∞
CREATE TABLE watcher_analytics_cache (
    id SERIAL PRIMARY KEY,
    cache_key VARCHAR(200) UNIQUE NOT NULL,
    data JSONB NOT NULL,
    expires_at TIMESTAMPTZ NOT NULL,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã
CREATE INDEX idx_wa_status ON watcher_alerts(status, created_at DESC);
CREATE INDEX idx_wa_seller ON watcher_alerts(seller_id, marketplace);
CREATE INDEX idx_ws_user ON watcher_subscriptions(user_id);
CREATE INDEX idx_wac_key ON watcher_analytics_cache(cache_key);
CREATE INDEX idx_wac_expires ON watcher_analytics_cache(expires_at);
```

---

## 6.9 –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å

### –ú–∞—Ç—Ä–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–∞

| –§—É–Ω–∫—Ü–∏—è | Staff | Manager | Senior | Director | Admin |
|---------|:-----:|:-------:|:------:|:--------:|:-----:|
| –î–∞—à–±–æ—Ä–¥: —Å–≤–æ–¥–∫–∞ | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –î–∞—à–±–æ—Ä–¥: –∞–ª–µ—Ä—Ç—ã | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –î–∞—à–±–æ—Ä–¥: –∫–∞—Ç–∞–ª–æ–≥–∏ –∏ —Ü–µ–Ω—ã | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –î–∞—à–±–æ—Ä–¥: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –î–∞—à–±–æ—Ä–¥: —Å–∏—Å—Ç–µ–º–∞ | ‚Äî | ‚Äî | ‚Äî | ‚Äî | ‚úÖ |
| Tool: —Ü–µ–Ω—ã –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Tool: –ø–æ–¥–ø–∏—Å–∫–∏ | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Tool: —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö | ‚Äî | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ |
| Tool: –≥–ª—É–±–æ–∫–∏–π AI-–∞–Ω–∞–ª–∏–∑ | ‚Äî | ‚Äî | ‚úÖ | ‚úÖ | ‚úÖ |
| Tool: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Collector | ‚Äî | ‚Äî | ‚Äî | ‚Äî | ‚úÖ |
| Tool: –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ | ‚Äî | ‚Äî | ‚Äî | ‚Äî | ‚úÖ |

–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –±—Ä–µ–Ω–¥–∞–º (`brand_id`) —á–µ—Ä–µ–∑ ADOLF Core Middleware.

---

## 6.10 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (Analyzer)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|:------------:|----------|
| `WATCHER_COLLECTOR_URL` | `http://10.0.0.2:3002` | URL Collector REST API (—á–µ—Ä–µ–∑ VPN) |
| `WATCHER_KNOWLEDGE_DIR` | `/data/knowledge/incoming/watcher` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏—ë–º–∞ Markdown |
| `WATCHER_QDRANT_COLLECTION` | `competitive_intelligence` | –ö–æ–ª–ª–µ–∫—Ü–∏—è Qdrant |
| `WATCHER_ALERT_CHECK_INTERVAL` | `3600` | –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ (—Å–µ–∫—É–Ω–¥—ã) |
| `WATCHER_ANALYTICS_TTL` | `21600` | TTL –∫—ç—à–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (—Å–µ–∫—É–Ω–¥—ã) |
| `WATCHER_AI_MODEL_ROUTINE` | `gpt-5-mini` | –ú–æ–¥–µ–ª—å –¥–ª—è —Ä—É—Ç–∏–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |
| `WATCHER_AI_MODEL_DEEP` | `claude-opus-4-5` | –ú–æ–¥–µ–ª—å –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ |

---

**–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** –§–µ–≤—Ä–∞–ª—å 2026  
**–í–µ—Ä—Å–∏—è:** 4.3  
**–°—Ç–∞—Ç—É—Å:** –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è pending)
