---
title: "–†–∞–∑–¥–µ–ª 8: –ó–∞–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"
mode: "wide"
---

**–ü—Ä–æ–µ–∫—Ç:** ADOLF ‚Äî AI-Driven Operations Layer Framework  
**–ú–æ–¥—É–ª—å:** Watcher  
**–í–µ—Ä—Å–∏—è:** 4.0  
**–î–∞—Ç–∞:** –§–µ–≤—Ä–∞–ª—å 2026

---

## 8.1 –°—Ç–∞—Ç—É—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Collector (VPS, Node.js)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –°—Ç–∞—Ç—É—Å |
|-----------|------|:-----:|:------:|
| Telegram-–±–æ—Ç | `bot.js` | ~400 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ | `scheduler.js` | ~350 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä | `orchestrator.js` | ~200 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∑–∞–¥–∞—á | `runner.js` | ~300 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| CDP Pool | `cdp-pool.js` | 339 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –°–∫–∞–Ω–µ—Ä WB | `SKILL/scanner_wb.js` | 811 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –°–∫–∞–Ω–µ—Ä Ozon | `SKILL/scanner_ozon.js` | 487 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –°–∫–∞–Ω–µ—Ä YM | `SKILL/scanner_ymarket.js` | 485 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –û–±–æ–≥–∞—Ç–∏—Ç–µ–ª—å WB | `SKILL/enricher_wb.js` | 336 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –û–±–æ–≥–∞—Ç–∏—Ç–µ–ª—å Ozon | `SKILL/enricher_ozon.js` | 309 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –û–±–æ–≥–∞—Ç–∏—Ç–µ–ª—å YM | `SKILL/enricher_ymarket.js` | 509 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –≠–º—É–ª—è—Ü–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è | `SKILL/human.js` | 304 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | `db.js` | 488 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| REST API | `api.js` | 462 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –í–µ–±-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | `monitor/server.js` | 779 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | `config.js` | 164 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |
| –£—Ç–∏–ª–∏—Ç—ã | `utils.js` | 31 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ |

**–ò—Ç–æ–≥–æ Collector:** ~6 754 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞, 17 —Ñ–∞–π–ª–æ–≤. –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω.

### Analyzer (–æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä, Python)

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –°—Ç–∞—Ç—É—Å |
|-----------|:------:|
| Knowledge Pipeline (JSON ‚Üí Markdown) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Markdown-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| –ü–µ—Ä–µ–¥–∞—á–∞ —Ñ–∞–π–ª–æ–≤ (rsync/NFS) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| FastAPI-—Ä–æ—É—Ç–µ—Ä | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| –î–∞—à–±–æ—Ä–¥ (–±–∞–Ω–Ω–µ—Ä—ã Open WebUI) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| AI-—á–∞—Ç (Tools) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| Celery-–∑–∞–¥–∞—á–∏ (–ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |
| PostgreSQL-—Å—Ö–µ–º–∞ (–∞–ª–µ—Ä—Ç—ã, –ø–æ–¥–ø–∏—Å–∫–∏, –∫—ç—à) | üî≤ –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è |

---

## 8.2 –ó–∞–¥–∞—á–∏: Collector

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### COL-001: Knowledge Pipeline

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–æ–¥—É–ª—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö Collector ‚Üí Markdown –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –º–æ–¥—É–ª—å Knowledge.

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Node.js –º–æ–¥—É–ª—å knowledge-pipeline.js –¥–ª—è Watcher Collector.
# –ü—É—Ç—å: /opt/watcher/knowledge-pipeline.js
#
# –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
# 1. triggerPipeline(sellerRowId) ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ runner.js –ø–æ—Å–ª–µ enrich
# 2. –ó–∞–≥—Ä—É–∑–∫–∞ product_details –∏–∑ SQLite (db.getProductDetailsBySeller)
# 3. –ó–∞–≥—Ä—É–∑–∫–∞ products –∏–∑ –¥–≤—É—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∫–∞–Ω–æ–≤ (db.getLastTwoScansProducts)
# 4. computeDiff() –¥–ª—è —Ü–µ–Ω–æ–≤—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
# 5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 3 Markdown-—Ñ–∞–π–ª–æ–≤:
#    - {mp}_seller_{id}_catalog.md (–æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥)
#    - {mp}_seller_{id}_diff.md (—Ü–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è)
#    - {mp}_seller_{id}_summary.md (—Å–≤–æ–¥–∫–∞)
# 6. YAML-–∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è RAG (—Å–º. –†–∞–∑–¥–µ–ª 6.2)
# 7. –ó–∞–ø–∏—Å—å –≤ /opt/watcher/knowledge/
# 8. –í—ã–∑–æ–≤ rsync –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
#
# –§–æ—Ä–º–∞—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤: —Å–º. –†–∞–∑–¥–µ–ª 6, —Å–µ–∫—Ü–∏—è 6.2
# –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: db.js, utils.js (computeDiff)
```

#### COL-002: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup

```bash
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π bash-—Å–∫—Ä–∏–ø—Ç /opt/watcher/backup.sh:
# 1. sqlite3 watcher.db ".backup /opt/watcher/backups/watcher_$(date +%F).db"
# 2. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ config.json, .env
# 3. tar.gz —Ç–µ–∫—É—â–∏—Ö results/*.json
# 4. –†–æ—Ç–∞—Ü–∏—è: —É–¥–∞–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–æ–≤ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
# 5. Cron: 0 2 * * * /opt/watcher/backup.sh
```

#### COL-003: Logrotate –¥–ª—è –ª–æ–≥–æ–≤ –∑–∞–¥–∞—á

```
# /etc/logrotate.d/watcher
/opt/watcher/logs/*.log {
    daily
    rotate 30
    compress
    missingok
    notifempty
}
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### COL-004: –£–ª—É—á—à–µ–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Monitor

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ `admin` / `admin` –≤ `server.js`. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ:

- –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–∏–Ω–∞/–ø–∞—Ä–æ–ª—è –∏–∑ `.env` –∏–ª–∏ `config.json`
- –•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è (bcrypt –∏–ª–∏ crypto.scryptSync)
- –¢–∞–π–º–∞—É—Ç —Å–µ—Å—Å–∏–∏ (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 7 –¥–Ω–µ–π)

#### COL-005: Graceful shutdown

–¢–µ–∫—É—â–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç `SIGTERM` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ:

- `cdp-pool.js`: –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–Ω—è—Ç—ã—Ö –ü–ö
- `bot.js` / `orchestrator.js`: –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö –∑–∞–¥–∞—á –∏–ª–∏ –ø–æ–º–µ—Ç–∫–∞ –∫–∞–∫ failed
- `monitor/server.js`: –∑–∞–∫—Ä—ã—Ç–∏–µ WebSocket-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- `api.js`: –∑–∞–∫—Ä—ã—Ç–∏–µ HTTP-—Å–µ—Ä–≤–µ—Ä–∞

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –î–æ–±–∞–≤—å graceful shutdown –≤–æ –≤—Å–µ Node.js –ø—Ä–æ—Ü–µ—Å—Å—ã Watcher:
# - process.on('SIGTERM', async () => { ... })
# - process.on('SIGINT', async () => { ... })
# - –î–ª—è bot.js: –ø–æ–º–µ—Ç–∏—Ç—å running –∑–∞–¥–∞—á–∏ –∫–∞–∫ failed
# - –î–ª—è cdp-pool.js: release all busy PCs
# - –î–ª—è api.js –∏ monitor: server.close()
# - –¢–∞–π–º–∞—É—Ç: 10 —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º process.exit(1)
```

#### COL-006: Health check —ç–Ω–¥–ø–æ–∏–Ω—Ç

–î–æ–±–∞–≤–∏—Ç—å `/health` –≤ –∫–∞–∂–¥—ã–π HTTP-—Å–µ—Ä–≤–∏—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ systemd –∏–ª–∏ –≤–Ω–µ—à–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤–∞:

| –°–µ—Ä–≤–∏—Å | –ü—É—Ç—å | –ü—Ä–æ–≤–µ—Ä–∫–∏ |
|--------|------|----------|
| CDP Pool :3000 | `/health` | pool.size &gt; 0, last poll &lt; 30s ago |
| API :3002 | `/health` | SQLite readable, last query &lt; 5s |
| Monitor :3001 | `/health` | WebSocket active, CDP Pool reachable |

#### COL-007: Rate limiting REST API

`api.js` –Ω–µ –∏–º–µ–µ—Ç rate limiting. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ—Ä—Ç–∞ –Ω–∞—Ä—É–∂—É (—á–µ—Ä–µ–∑ VPN) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ:

- 100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É –Ω–∞ IP (–∏–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ)
- 429 Too Many Requests –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### COL-008: –ú–µ—Ç—Ä–∏–∫–∏ –∏ Prometheus

–≠–∫—Å–ø–æ—Ä—Ç –º–µ—Ç—Ä–∏–∫ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Prometheus –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| `watcher_pool_total` | gauge | –í—Å–µ–≥–æ –ü–ö –≤ –ø—É–ª–µ |
| `watcher_pool_online` | gauge | –û–Ω–ª–∞–π–Ω –ü–ö |
| `watcher_pool_busy` | gauge | –ó–∞–Ω—è—Ç—ã—Ö –ü–ö |
| `watcher_scans_total` | counter | –°–∫–∞–Ω–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ |
| `watcher_scans_failed` | counter | –°–∫–∞–Ω–æ–≤ –ø—Ä–æ–≤–∞–ª–µ–Ω–æ |
| `watcher_products_total` | gauge | –¢–æ–≤–∞—Ä–æ–≤ –≤ –±–∞–∑–µ |
| `watcher_scan_duration_seconds` | histogram | –í—Ä–µ–º—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |

#### COL-009: –ú–∏–≥—Ä–∞—Ü–∏—è SQLite ‚Üí PostgreSQL

–î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø—Ä–µ–≤—ã—Å–∏—Ç 50‚Äì100) —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ PostgreSQL. WAL-—Ä–µ–∂–∏–º SQLite –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: –æ–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

#### COL-010: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–ë–æ—Ç —É–≤–µ–¥–æ–º–ª—è–µ—Ç –æ –∑–∞–¥–∞—á–∞—Ö, –Ω–æ –Ω–µ –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã:

- –ü–ö –æ—Ç–∫–ª—é—á–∏–ª—Å—è –∏ –Ω–µ –≤–µ—Ä–Ω—É–ª—Å—è &gt; 1 —á–∞—Å–∞
- REST API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω &gt; 90%
- SQLite: –æ—à–∏–±–∫–∏ –∑–∞–ø–∏—Å–∏

---

## 8.3 –ó–∞–¥–∞—á–∏: Analyzer

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### ANA-001: FastAPI-—Ä–æ—É—Ç–µ—Ä

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π FastAPI-—Ä–æ—É—Ç–µ—Ä –¥–ª—è Watcher Analyzer.
# –§–∞–π–ª: /opt/adolf/modules/watcher/router.py
# Prefix: /api/v1/watcher
#
# –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–∞—à–±–æ—Ä–¥–∞:
#   GET /dashboard/alerts ‚Äî –∞–ª–µ—Ä—Ç—ã (–∏–∑ watcher_alerts PG)
#   GET /dashboard/sellers ‚Äî –æ–±–∑–æ—Ä –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤ (–∏–∑ Qdrant + PG cache)
#   GET /dashboard/seller/{id}/catalog ‚Äî –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥–∞–≤—Ü–∞
#   GET /dashboard/seller/{id}/enriched ‚Äî –æ–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
#   GET /dashboard/seller/{id}/price-history ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
#   GET /dashboard/seller/{id}/diff ‚Äî diff –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∫–∞–Ω–æ–≤
#   GET /dashboard/analytics/pricing ‚Äî —Ü–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
#   GET /dashboard/analytics/assortment ‚Äî –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç
#   GET /dashboard/analytics/bestsellers ‚Äî –±–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã
#   GET /dashboard/analytics/compare ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
#   GET /dashboard/analytics/stock ‚Äî –æ—Å—Ç–∞—Ç–∫–∏ –∏ —Ä–∞–∑–º–µ—Ä—ã
#   GET /dashboard/system ‚Äî —Å—Ç–∞—Ç—É—Å Collector (admin)
#
# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: depends=[check_role("manager")]
# –ò—Å—Ç–æ—á–Ω–∏–∫–∏: Qdrant (RAG), PostgreSQL (–∫—ç—à), Collector API (fallback)
# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –†–∞–∑–¥–µ–ª 6.3-6.4
```

#### ANA-002: –î–∞—à–±–æ—Ä–¥ Open WebUI

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–∞—à–±–æ—Ä–¥–∞ Watcher –¥–ª—è Open WebUI.
# –î–∞—à–±–æ—Ä–¥ ‚Äî –±–∞–Ω–Ω–µ—Ä–Ω—ã–π, –±–µ–∑ —Å—Ç—Ä–æ–∫–∏ –≤–≤–æ–¥–∞ –¥–ª—è –ò–ò.
#
# –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
#   –°—Ç—Ä–æ–∫–∞ 1: 4 —á–∏—Å–ª–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ (–ø—Ä–æ–¥–∞–≤—Ü—ã, —Ç–æ–≤–∞—Ä—ã, –∞–ª–µ—Ä—Ç—ã, –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫–∞–Ω)
#   –°—Ç—Ä–æ–∫–∞ 2: –±–∞–Ω–Ω–µ—Ä—ã (–ê–ª–µ—Ä—Ç—ã, –¶–µ–Ω–æ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ö–∞—Ç–∞–ª–æ–≥–∏, –û–±–æ–≥–∞—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
#   –°—Ç—Ä–æ–∫–∞ 3: –±–∞–Ω–Ω–µ—Ä—ã (–¶–µ–Ω–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, –ë–µ—Å—Ç—Å–µ–ª–ª–µ—Ä—ã, –°—Ä–∞–≤–Ω–µ–Ω–∏–µ, –ê—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç)
#   –°—Ç—Ä–æ–∫–∞ 4: –±–∞–Ω–Ω–µ—Ä—ã (–°—Ç–∞—Ç—É—Å Collector, –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á) ‚Äî —Ç–æ–ª—å–∫–æ Admin
#
# –ö–∞–∂–¥—ã–π –±–∞–Ω–Ω–µ—Ä ‚Üí –æ—Ç—á—ë—Ç —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ (–º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å, –ø—Ä–æ–¥–∞–≤–µ—Ü, –ø–µ—Ä–∏–æ–¥)
# –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ —Å —Ç–∞–±–∞–º–∏
#
# –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: shadcn/ui, Tailwind CSS, Lucide Icons
# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –†–∞–∑–¥–µ–ª 6.4
```

#### ANA-003: AI-—á–∞—Ç Tools

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π –Ω–∞–±–æ—Ä Open WebUI Tools –¥–ª—è AI-—á–∞—Ç–∞ Watcher.
# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: /opt/adolf/tools/
#
# Tools:
#   watcher_get_prices.py ‚Äî —Ü–µ–Ω—ã –ø–æ SKU
#   watcher_price_history.py ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω
#   watcher_compare_competitors.py ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤
#   watcher_get_alerts.py ‚Äî –∞–ª–µ—Ä—Ç—ã
#   watcher_add_subscription.py ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
#   watcher_list_subscriptions.py ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫
#   watcher_mark_alert_read.py ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∞–ª–µ—Ä—Ç
#   watcher_agent_status.py ‚Äî —Å—Ç–∞—Ç—É—Å Collector (admin)
#   watcher_agent_command.py ‚Äî –∫–æ–º–∞–Ω–¥–∞ Collector (admin)
#   watcher_settings.py ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–µ—Ä—Ç–æ–≤ (admin)
#
# –ö–∞–∂–¥—ã–π Tool: –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è LLM, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, HTTP –∫ Analyzer API
# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –†–∞–∑–¥–µ–ª 6.5
```

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### ANA-004: Celery-–∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Celery-–∑–∞–¥–∞—á–∏ –¥–ª—è –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç—á—ë—Ç–æ–≤ –¥–∞—à–±–æ—Ä–¥–∞.
# –§–∞–π–ª: /opt/adolf/modules/watcher/tasks.py
#
# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ:
#   watcher.pregenerate_alerts ‚Äî –∫–∞–∂–¥—ã–π —á–∞—Å
#   watcher.pregenerate_pricing ‚Äî –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
#   watcher.pregenerate_bestsellers ‚Äî –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
#   watcher.pregenerate_comparison ‚Äî –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
#   watcher.pregenerate_assortment ‚Äî –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
#   watcher.sync_knowledge ‚Äî –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω
#   watcher.cleanup_alerts ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω–æ 03:00
#   watcher.collector_health ‚Äî –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω
#
# –ö–∞–∂–¥–∞—è –∑–∞–¥–∞—á–∞: –∑–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö ‚Üí –∞–≥—Ä–µ–≥–∞—Ü–∏—è ‚Üí —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ watcher_analytics_cache
# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –†–∞–∑–¥–µ–ª 6.6
```

#### ANA-005: PostgreSQL-–º–∏–≥—Ä–∞—Ü–∏–∏

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Alembic-–º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–∞–±–ª–∏—Ü Watcher Analyzer:
# - watcher_alerts
# - watcher_alert_settings
# - watcher_subscriptions
# - watcher_analytics_cache
#
# SQL-—Å—Ö–µ–º–∞: –†–∞–∑–¥–µ–ª 6.8
```

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

#### ANA-006: –≠–∫—Å–ø–æ—Ä—Ç –≤ XLSX

```python
# –ü—Ä–æ–º–ø—Ç –¥–ª—è Claude Code:
#
# –°–æ–∑–¥–∞–π Celery-–∑–∞–¥–∞—á—É watcher.export_data –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ XLSX.
# –¢—Ä–∏–≥–≥–µ—Ä: AI-—á–∞—Ç Tool watcher_export (Senior+)
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: seller_id, marketplace, period, type (catalog/diff/history)
# –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: openpyxl
# –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ñ–∞–π–ª –≤ /opt/adolf/exports/, —Å—Å—ã–ª–∫–∞ –≤ –æ—Ç–≤–µ—Ç–µ —á–∞—Ç–∞
```

---

## 8.4 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥

### Collector

| ID | –û–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|------|:---------:|
| TD-001 | –ó–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ credentials Monitor (admin/admin) | `monitor/server.js:33-34` | –í—ã—Å–æ–∫–∏–π |
| TD-002 | FRP auth token –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ | `cdp-pool.js:10`, `monitor/server.js:14` | –°—Ä–µ–¥–Ω–∏–π |
| TD-003 | –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ graceful shutdown | –í—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã | –°—Ä–µ–¥–Ω–∏–π |
| TD-004 | –ù–µ—Ç health check —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ | `cdp-pool.js`, `api.js`, `monitor/server.js` | –°—Ä–µ–¥–Ω–∏–π |
| TD-005 | –ù–µ—Ç rate limiting REST API | `api.js` | –°—Ä–µ–¥–Ω–∏–π |
| TD-006 | `scanner_wb.js` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é human-—ç–º—É–ª—è—Ü–∏–∏ (811 —Å—Ç—Ä–æ–∫), –¥—É–±–ª–∏—Ä—É—è `human.js` | `SKILL/scanner_wb.js` | –ù–∏–∑–∫–∏–π |
| TD-007 | –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ | `logs/` | –ù–∏–∑–∫–∏–π |
| TD-008 | `frp-port-memory.json` –º–æ–∂–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –∫—Ä–∞—à–µ | `monitor/server.js` | –ù–∏–∑–∫–∏–π |

### –ö–æ–¥ scanner\_wb.js (TD-006)

`scanner_wb.js` (811 —Å—Ç—Ä–æ–∫) ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫–∞–Ω–µ—Ä —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π human-—ç–º—É–ª—è—Ü–∏–∏. –°–∫–∞–Ω–µ—Ä—ã Ozon –∏ YM –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–π –º–æ–¥—É–ª—å `human.js`. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥: –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –æ–±—â–∏–π –∫–æ–¥ –≤ `human.js`, –æ—Å—Ç–∞–≤–∏—Ç—å –≤ `scanner_wb.js` —Ç–æ–ª—å–∫–æ WB-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É. –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ: ~300 —Å—Ç—Ä–æ–∫.

---

## 8.5 –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã

| –ú–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –í–ª–∏—è–Ω–∏–µ | –û–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å |
|-------------|-------------|---------|---------------|
| Wildberries | ¬´–ü–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ¬ª (anti-bot) | –ó–∞–¥–µ—Ä–∂–∫–∞ 60—Å, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω—É–∂–Ω–æ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ + Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ |
| Wildberries | Detail API –∏–Ω–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç PoW | –ß–∞—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö enricher –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ | Fallback –Ω–∞ –¥–∞–Ω–Ω—ã–µ —Å–∫–∞–Ω–µ—Ä–∞ |
| Ozon | PoW / Captcha –ø—Ä–∏ –≤—Ö–æ–¥–µ | –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–∞—è cookie-—Å–µ—Å—Å–∏—è | –û–∂–∏–¥–∞–Ω–∏–µ –¥–æ 60—Å, retry |
| Ozon | Entrypoint API –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è | –û–±–æ–≥–∞—Ç–∏—Ç–µ–ª—å –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤, –∞–ª–µ—Ä—Ç |
| –Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç | SmartCaptcha | –†—É—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ, –∑–∞–¥–µ—Ä–∂–∫–∞ | –ü–∞—É–∑–∞ + Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ |
| –Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç | –¢—Ä–µ–±—É–µ—Ç—Å—è `SELLER_SLUG` | –ù–µ–ª—å–∑—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ ID | –†—É—á–Ω–æ–π –≤–≤–æ–¥ slug –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ |

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –ö–æ–≥–¥–∞ –∫—Ä–∏—Ç–∏—á–Ω–æ |
|-------------|----------|----------------|
| SQLite: –æ–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å | WAL —Å–º—è–≥—á–∞–µ—Ç, –Ω–æ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö –≤–æ–∑–º–æ–∂–µ–Ω SQLITE\_BUSY | &gt; 5 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á |
| FRP: –º–∞–∫—Å–∏–º—É–º 100 –ø–æ—Ä—Ç–æ–≤ | –î–∏–∞–ø–∞–∑–æ–Ω 9300‚Äì9399 | &gt; 100 –ü–ö |
| –ü–ö —Å Chrome: —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–æ—Å—Ç—å | –ö–∞–∂–¥—ã–π —Å–∫–∞–Ω –∑–∞–Ω–∏–º–∞–µ—Ç ~100% CPU –Ω–∞ –ü–ö | –ù–µ –±–æ–ª–µ–µ 1 –∑–∞–¥–∞—á–∏ –Ω–∞ –ü–ö |
| VPS: –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ | JSON-—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã + –ª–æ–≥–∏ + SQLite | –ü—Ä–∏ &gt; 100 –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ √ó –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ |

---

## 8.6 Roadmap

### v4.1 (–±–ª–∏–∂–∞–π—à–µ–µ)

- COL-001: Knowledge Pipeline (—Å–≤—è–∑–∫–∞ Collector ‚Üí Knowledge)
- COL-002: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup
- COL-003: Logrotate
- TD-001: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ credentials

### v4.2 (—Å–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø)

- ANA-001: FastAPI-—Ä–æ—É—Ç–µ—Ä Analyzer
- ANA-002: –î–∞—à–±–æ—Ä–¥ Open WebUI (–±–∞–Ω–Ω–µ—Ä—ã)
- ANA-003: AI-—á–∞—Ç Tools
- ANA-005: PostgreSQL-–º–∏–≥—Ä–∞—Ü–∏–∏

### v4.3 (—Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è)

- COL-005: Graceful shutdown
- COL-006: Health check
- COL-007: Rate limiting
- ANA-004: Celery –ø—Ä–µ–¥–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- TD-006: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ scanner\_wb.js ‚Üí human.js

### v5.0 (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)

- COL-009: –ú–∏–≥—Ä–∞—Ü–∏—è SQLite ‚Üí PostgreSQL (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- COL-008: Prometheus-–º–µ—Ç—Ä–∏–∫–∏
- ANA-006: –≠–∫—Å–ø–æ—Ä—Ç XLSX
- Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (Open WebUI v2.0)
- –ì–æ–ª–æ—Å–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Groq Whisper + OpenAI TTS)

---

**–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** –§–µ–≤—Ä–∞–ª—å 2026  
**–í–µ—Ä—Å–∏—è:** 4.0  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω—ã–π
