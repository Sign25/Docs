# ADOLF CORE v4.0 โ ะะฒะตะดะตะฝะธะต

**ะะปั ะบะพะณะพ ััะพั ะดะพะบัะผะตะฝั:** Junior-ัะฐะทัะฐะฑะพััะธะบะธ, ะฝะพะฒัะต ััะฐััะฝะธะบะธ ะบะพะผะฐะฝะดั  
**ะฆะตะปั:** ะะพะฝััั ะบะฐะบ ััััะพะตะฝะฐ ัะธััะตะผะฐ ะธ ะบะฐะบ ะตั ะบะพะผะฟะพะฝะตะฝัั ัะฐะฑะพัะฐัั ะฒะผะตััะต  
**ะัะตะผั ะฝะฐ ะธะทััะตะฝะธะต:** 30-40 ะผะธะฝัั

---

## 1. ะงัะพ ัะฐะบะพะต ADOLF?

### 1.1 ะัะพัััะผะธ ัะปะพะฒะฐะผะธ

**ADOLF** โ ััะพ ะบะพัะฟะพัะฐัะธะฒะฝัะน AI-ะฐััะธััะตะฝั ะดะปั e-commerce ะบะพะผะฟะฐะฝะธะธ. ะัะตะดััะฐะฒั, ััะพ ั ัะตะฑั ะตััั ัะผะฝัะน ะฟะพะผะพัะฝะธะบ, ะบะพัะพััะน:

- ะัะฒะตัะฐะตั ะฝะฐ ะฒะพะฟัะพัั ัะพัััะดะฝะธะบะพะฒ ะฟะพ ะฒะฝัััะตะฝะฝะธะผ ะดะพะบัะผะตะฝัะฐะผ ะบะพะผะฟะฐะฝะธะธ
- ะะพะผะพะณะฐะตั ะพะฑัะฐะฑะฐััะฒะฐัั ะพัะทัะฒั ะฟะพะบัะฟะฐัะตะปะตะน ะฝะฐ ะผะฐัะบะตัะฟะปะตะนัะฐั
- ะกะปะตะดะธั ะทะฐ ัะตะฝะฐะผะธ ะบะพะฝะบััะตะฝัะพะฒ
- ะะตะฝะตัะธััะตั ะพะฟะธัะฐะฝะธั ัะพะฒะฐัะพะฒ
- ะคะพัะผะธััะตั ัะธะฝะฐะฝัะพะฒัะต ะพััััั

ะัั ััะพ โ ัะตัะตะท ะฟัะพััะพะน ัะฐั-ะธะฝัะตััะตะนั, ะฟะพัะพะถะธะน ะฝะฐ ChatGPT.

### 1.2 ะงัะพ ัะฐะบะพะต ADOLF CORE?

**ADOLF CORE** โ ััะพ ยซัะดัะพยป ัะธััะตะผั. ะญัะพ ััะฝะดะฐะผะตะฝั, ะฝะฐ ะบะพัะพัะพะผ ัะฐะฑะพัะฐัั ะฒัะต ะพััะฐะปัะฝัะต ะผะพะดัะปะธ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                      ADOLF (ะฒัั ัะธััะตะผะฐ)                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                              โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ   โ                   ADOLF CORE                         โ   โ
โ   โ         (ัะดัะพ โ ััะฝะดะฐะผะตะฝั ัะธััะตะผั)                   โ   โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
โ                            โ                                 โ
โ         โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโ             โ
โ         โ                  โ                  โ             โ
โ         โผ                  โผ                  โผ             โ
โ   โโโโโโโโโโโโ      โโโโโโโโโโโโ      โโโโโโโโโโโโ         โ
โ   โReputationโ      โ  Watcher โ      โ   CFO    โ   ...   โ
โ   โ(ะพัะทัะฒั)  โ      โ  (ัะตะฝั)  โ      โ(ัะธะฝะฐะฝัั) โ         โ
โ   โโโโโโโโโโโโ      โโโโโโโโโโโโ      โโโโโโโโโโโโ         โ
โ                                                              โ
โ              ะคัะฝะบัะธะพะฝะฐะปัะฝัะต ะผะพะดัะปะธ                           โ
โ       (ัะฐะฑะพัะฐัั ะฟะพะฒะตัั Core, ะธัะฟะพะปัะทััั ะตะณะพ API)            โ
โ                                                              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

**ะะฝะฐะปะพะณะธั:** CORE โ ััะพ ะบะฐะบ ััะฝะดะฐะผะตะฝั ะธ ะบะพะผะผัะฝะธะบะฐัะธะธ ะดะพะผะฐ (ัะปะตะบััะธัะตััะฒะพ, ะฒะพะดะพะฟัะพะฒะพะด, ะธะฝัะตัะฝะตั). ะคัะฝะบัะธะพะฝะฐะปัะฝัะต ะผะพะดัะปะธ โ ััะพ ะบะพะผะฝะฐัั (ะบััะฝั, ัะฟะฐะปัะฝั, ะฒะฐะฝะฝะฐั). ะะพะผะฝะฐัั ะฝะต ะผะพะณัั ัะฐะฑะพัะฐัั ะฑะตะท ััะฝะดะฐะผะตะฝัะฐ ะธ ะบะพะผะผัะฝะธะบะฐัะธะน.

### 1.3 ะงัะพ ะฒัะพะดะธั ะฒ CORE?

| ะะพะผะฟะพะฝะตะฝั | ะะปั ัะตะณะพ ะฝัะถะตะฝ | ะะฝะฐะปะพะณะธั ะธะท ะถะธะทะฝะธ |
|-----------|----------------|-------------------|
| **Open WebUI** | ะะฝัะตััะตะนั (ัะฐั) | ะขะตะปะตัะพะฝ, ัะตัะตะท ะบะพัะพััะน ัั ะพะฑัะฐะตัััั |
| **Middleware** | ะะพะณะธะบะฐ ะธ ะฑะตะทะพะฟะฐัะฝะพััั | ะกะตะบัะตัะฐัั, ะบะพัะพััะน ัะตัะฐะตั ะบะพะผั ะผะพะถะฝะพ ะทะฒะพะฝะธัั |
| **ETL** | ะะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ | ะกะบะฐะฝะตั + ะฐััะธะฒะฐัะธัั |
| **PostgreSQL** | ะฅัะฐะฝะตะฝะธะต ะดะฐะฝะฝัั | ะะฐััะพัะตะบะฐ ั ะธะฝัะพัะผะฐัะธะตะน |
| **Redis** | ะัะตัะตะดั ะทะฐะดะฐั | ะกะฟะธัะพะบ ะดะตะป ะฝะฐ ััะธะบะตัะฐั |
| **Nginx** | ะขะพัะบะฐ ะฒัะพะดะฐ | ะััะฐะฝะฝะธะบ ะฝะฐ ะฒัะพะดะต ะฒ ะทะดะฐะฝะธะต |

---

## 2. ะะฐะบ ะฒัั ััััะพะตะฝะพ (ะฐััะธัะตะบัััะฐ)

### 2.1 ะะฑัะฐั ััะตะผะฐ

```mermaid
graph TB
    subgraph USERS["๐ฅ ะะพะปัะทะพะฒะฐัะตะปะธ"]
        U1["ะะตะฝะตะดะถะตั<br/>(ะฑัะฐัะทะตั)"]
        U2["ะะธัะตะบัะพั<br/>(ัะตะปะตัะพะฝ)"]
    end
    
    subgraph VPS["๐ฅ๏ธ ะะฐั ัะตัะฒะตั (VPS)"]
        NGINX["๐ช Nginx<br/>(ะพััะฐะฝะฝะธะบ)"]
        
        subgraph DOCKER["Docker ะบะพะฝัะตะนะฝะตัั"]
            OWUI["๐ฌ Open WebUI<br/>(ัะฐั-ะธะฝัะตััะตะนั)"]
            MW["โ๏ธ Middleware<br/>(ะผะพะทะณ ัะธััะตะผั)"]
            ETL["๐ ETL<br/>(ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะพะฒ)"]
            CELERY["โฐ Celery<br/>(ัะพะฝะพะฒัะต ะทะฐะดะฐัะธ)"]
        end
        
        REDIS["๐ฎ Redis<br/>(ะพัะตัะตะดั)"]
        PG["๐๏ธ PostgreSQL<br/>(ะฑะฐะทะฐ ะดะฐะฝะฝัั)"]
    end
    
    subgraph EXTERNAL["โ๏ธ ะะฝะตัะฝะธะต ัะตัะฒะธัั"]
        TWAI["๐ค Timeweb AI<br/>(ะธัะบััััะฒะตะฝะฝัะน ะธะฝัะตะปะปะตะบั)"]
        TWKB["๐ Timeweb KB<br/>(ะฑะฐะทะฐ ะทะฝะฐะฝะธะน)"]
        OPENAI["๐ง OpenAI<br/>(OCR, ะบะปะฐััะธัะธะบะฐัะธั)"]
    end
    
    U1 & U2 -->|HTTPS| NGINX
    NGINX --> OWUI
    NGINX --> MW
    OWUI <--> MW
    MW --> TWAI
    TWAI --> TWKB
    MW --> PG
    MW --> REDIS
    REDIS --> CELERY
    CELERY --> PG
    ETL --> OPENAI
    ETL --> TWKB
    ETL --> PG
```

### 2.2 ะงัะพ ะดะตะปะฐะตั ะบะฐะถะดัะน ะบะพะผะฟะพะฝะตะฝั

#### ๐ช Nginx โ ยซะััะฐะฝะฝะธะบยป

**ะงัะพ ััะพ:** ะะตะฑ-ัะตัะฒะตั, ะบะพัะพััะน ะฟัะธะฝะธะผะฐะตั ะฒัะต ะฒัะพะดััะธะต ะทะฐะฟัะพัั.

**ะะฐัะตะผ ะฝัะถะตะฝ:**
- ะจะธัััะตั ัะพะตะดะธะฝะตะฝะธะต (HTTPS) โ ััะพะฑั ะฝะธะบัะพ ะฝะต ะฟะพะดัะปััะฐะป
- ะะตัะฐะตั ะบัะดะฐ ะฝะฐะฟัะฐะฒะธัั ะทะฐะฟัะพั โ ะฒ ัะฐั ะธะปะธ ะฒ API
- ะะฐัะธัะฐะตั ะพั ะฐัะฐะบ โ ะฑะปะพะบะธััะตั ะฟะพะดะพะทัะธัะตะปัะฝัะต ะทะฐะฟัะพัั

**ะัะธะผะตั ัะฐะฑะพัั:**
```
ะะพะปัะทะพะฒะฐัะตะปั ะพัะบััะฒะฐะตั https://adolf.su
    โ
    โผ
Nginx ะฟัะธะฝะธะผะฐะตั ะทะฐะฟัะพั
    โ
    โโโบ ะะฐะฟัะพั ะฝะฐ /          โ ะพัะฟัะฐะฒะธัั ะฒ Open WebUI (ัะฐั)
    โโโบ ะะฐะฟัะพั ะฝะฐ /api/v1/   โ ะพัะฟัะฐะฒะธัั ะฒ Middleware (API)
    โโโบ ะะฐะฟัะพั ะฝะฐ /ws/       โ ะพัะฟัะฐะฒะธัั ะฒ WebSocket (ัะฒะตะดะพะผะปะตะฝะธั)
```

#### ๐ฌ Open WebUI โ ยซะงะฐั-ะธะฝัะตััะตะนัยป

**ะงัะพ ััะพ:** ะะตะฑ-ะฟัะธะปะพะถะตะฝะธะต ะดะปั ะพะฑัะตะฝะธั ั AI. ะะพัะพะถะต ะฝะฐ ChatGPT.

**ะะฐัะตะผ ะฝัะถะตะฝ:**
- ะะพะบะฐะทัะฒะฐะตั ะบัะฐัะธะฒัะน ัะฐั
- ะะพะทะฒะพะปัะตั ะทะฐะณััะถะฐัั ัะฐะนะปั
- ะะพะบะฐะทัะฒะฐะตั ัะฒะตะดะพะผะปะตะฝะธั
- ะะฐะฑะพัะฐะตั ะฝะฐ ัะตะปะตัะพะฝะต (PWA)

**ะงัะพ ัะผะตะตั ะฟะพะปัะทะพะฒะฐัะตะปั:**
- ะะธัะฐัั ัะพะพะฑัะตะฝะธั AI
- ะะฐะณััะถะฐัั ะดะพะบัะผะตะฝัั
- ะะธะดะตัั ะธััะพัะธั ะฟะตัะตะฟะธัะบะธ
- ะะพะปััะฐัั ัะฒะตะดะพะผะปะตะฝะธั

```mermaid
graph LR
    subgraph OWUI["Open WebUI"]
        CHAT["๐ฌ ะงะฐั"]
        UPLOAD["๐ค ะะฐะณััะทะบะฐ ัะฐะนะปะพะฒ"]
        NOTIFY["๐ ะฃะฒะตะดะพะผะปะตะฝะธั"]
        MENU["๐ ะะตะฝั"]
    end
    
    USER["๐ค ะะพะปัะทะพะฒะฐัะตะปั"] --> CHAT
    USER --> UPLOAD
    NOTIFY --> USER
    MENU --> CHAT
```

#### โ๏ธ Middleware โ ยซะะพะทะณ ัะธััะตะผัยป

**ะงัะพ ััะพ:** ะกะตัะฒะตัะฝะพะต ะฟัะธะปะพะถะตะฝะธะต ะฝะฐ Python (FastAPI), ะบะพัะพัะพะต ัะฟัะฐะฒะปัะตั ะฒัะตะน ะปะพะณะธะบะพะน.

**ะะฐัะตะผ ะฝัะถะตะฝ:**

1. **ะะฒัะพัะธะทะฐัะธั** โ ะฟัะพะฒะตััะตั ะบัะพ ัั ัะฐะบะพะน
2. **ะัะฐะฒะฐ ะดะพัััะฟะฐ** โ ัะตัะฐะตั ััะพ ัะตะฑะต ะผะพะถะฝะพ ะฒะธะดะตัั
3. **ะะพััะธะฝะณ** โ ะฝะฐะฟัะฐะฒะปัะตั ะทะฐะฟัะพัั ะบัะดะฐ ะฝัะถะฝะพ
4. **ะคะธะปัััะฐัะธั** โ ัะบััะฒะฐะตั ััะถะธะต ะดะฐะฝะฝัะต
5. **ะะพะณะธัะพะฒะฐะฝะธะต** โ ะทะฐะฟะธััะฒะฐะตั ะบัะพ ััะพ ะดะตะปะฐะป

**ะะฐะบ ัะฐะฑะพัะฐะตั (ะฟัะธะผะตั):**

```mermaid
sequenceDiagram
    participant U as ๐ค ะะตะฝะตะดะถะตั<br/>(ะฑัะตะฝะด: ะัะฐะฝะฐ)
    participant MW as โ๏ธ Middleware
    participant AI as ๐ค Timeweb AI
    participant KB as ๐ ะะฐะทะฐ ะทะฝะฐะฝะธะน
    
    U->>MW: "ะะฐะบะธะต ัะฐะทะผะตัั ั ััะดะธ?"
    
    Note over MW: 1. ะัะพะฒะตัะบะฐ: ะบัะพ ััะพ?
    MW->>MW: ะญัะพ ะะตะฝะตะดะถะตั ะฑัะตะฝะดะฐ "ะัะฐะฝะฐ"
    
    Note over MW: 2. ะะพะดะธัะธะบะฐัะธั ะทะฐะฟัะพัะฐ
    MW->>MW: ะะพะฑะฐะฒะธัั ัะธะปััั:<br/>brand_id = "ohana"
    
    MW->>AI: ะะฐะฟัะพั + ัะธะปัััั
    AI->>KB: ะะพะธัะบ (ัะพะปัะบะพ ะัะฐะฝะฐ)
    KB-->>AI: ะะพะบัะผะตะฝัั ะัะฐะฝั
    AI-->>MW: "ะะฐะทะผะตัั: S, M, L, XL..."
    
    Note over MW: 3. ะะพะณะธัะพะฒะฐะฝะธะต
    MW->>MW: ะะฐะฟะธัะฐัั ะฒ audit_log
    
    MW-->>U: "ะะฐะทะผะตัั: S, M, L, XL..."
```

**ะะฐะถะฝะพ ะฟะพะฝััั:** Middleware ะะ ััะฐะฝะธั ะดะฐะฝะฝัะต ะฟะพะปัะทะพะฒะฐัะตะปะตะน ะฝะฐะดะพะปะณะพ. ะะฝ ัะพะปัะบะพ ะพะฑัะฐะฑะฐััะฒะฐะตั ะทะฐะฟัะพัั ะธ ะฟะตัะตะดะฐัั ะธั ะดะฐะปััะต.

#### ๐ ETL โ ยซะะฑัะฐะฑะพััะธะบ ะดะพะบัะผะตะฝัะพะฒยป

**ะงัะพ ััะพ:** ะคะพะฝะพะฒัะน ะฟัะพัะตัั, ะบะพัะพััะน ะฟัะตะฒัะฐัะฐะตั ะทะฐะณััะถะตะฝะฝัะต ัะฐะนะปั ะฒ ัะตะบัั ะดะปั AI.

**ETL ัะฐััะธััะพะฒัะฒะฐะตััั ะบะฐะบ:**
- **E**xtract (ะธะทะฒะปะตัั) โ ะดะพััะฐัั ัะตะบัั ะธะท ัะฐะนะปะฐ
- **T**ransform (ะฟัะตะพะฑัะฐะทะพะฒะฐัั) โ ะฟัะธะฒะตััะธ ะบ ะตะดะธะฝะพะผั ัะพัะผะฐัั
- **L**oad (ะทะฐะณััะทะธัั) โ ะพัะฟัะฐะฒะธัั ะฒ ะฑะฐะทั ะทะฝะฐะฝะธะน

**ะะฐัะตะผ ะฝัะถะตะฝ:**

AI ะฝะต ัะผะตะตั ัะธัะฐัั PDF ะธะปะธ Excel ะฝะฐะฟััะผัั. ะะผั ะฝัะถะตะฝ ัะธัััะน ัะตะบัั. ETL ะดะตะปะฐะตั ััั ัะฐะฑะพัั.

**ะะฐะบ ัะฐะฑะพัะฐะตั:**

```mermaid
flowchart LR
    subgraph INPUT["๐ฅ ะัะพะดััะธะต ัะฐะนะปั"]
        PDF["๐ PDF"]
        XLSX["๐ Excel"]
        DOCX["๐ Word"]
        IMG["๐ผ๏ธ ะะฐััะธะฝะบะฐ"]
    end
    
    subgraph ETL["โ๏ธ ETL ะฟัะพัะตัั"]
        WATCH["๐ Watchdog<br/>(ัะปะตะดะธั ะทะฐ ะฟะฐะฟะบะพะน)"]
        CONV["๐ ะะพะฝะฒะตััะตั<br/>(ะธะทะฒะปะตะบะฐะตั ัะตะบัั)"]
        CLASS["๐ท๏ธ ะะปะฐััะธัะธะบะฐัะพั<br/>(ะพะฟัะตะดะตะปัะตั ัะธะฟ)"]
    end
    
    subgraph OUTPUT["๐ค ะะตะทัะปััะฐั"]
        MD["๐ Markdown<br/>(ัะธัััะน ัะตะบัั)"]
        KB["๐ ะะฐะทะฐ ะทะฝะฐะฝะธะน"]
        ARCH["๐ฆ ะััะธะฒ"]
    end
    
    PDF & XLSX & DOCX & IMG --> WATCH
    WATCH --> CONV
    CONV --> CLASS
    CLASS --> MD
    MD --> KB
    MD --> ARCH
```

**ะัะธะผะตั ะฟัะตะพะฑัะฐะทะพะฒะฐะฝะธั:**

```
ะะซะะ (Excel-ัะฐะนะป):                      ะกะขะะะ (Markdown):
โโโโโโโโโโโฌโโโโโโโโโฌโโโโโโโโ           ---
โ ะะฐะทะผะตั  โ ะััะดั  โ ะะปะธะฝะฐ โ           title: ะะฐะทะผะตัะฝะฐั ัะตัะบะฐ ััะดะธ
โโโโโโโโโโโผโโโโโโโโโผโโโโโโโโค           category: product
โ S       โ 100    โ 65    โ           brand_id: ohana_market
โ M       โ 106    โ 68    โ           ---
โ L       โ 112    โ 71    โ           
โโโโโโโโโโโดโโโโโโโโโดโโโโโโโโ           # ะะฐะทะผะตัะฝะฐั ัะตัะบะฐ ััะดะธ
                                       
                                       | ะะฐะทะผะตั | ะััะดั | ะะปะธะฝะฐ |
                                       |--------|-------|-------|
                                       | S      | 100   | 65    |
                                       | M      | 106   | 68    |
                                       | L      | 112   | 71    |
```

#### ๐๏ธ PostgreSQL โ ยซะะฐะทะฐ ะดะฐะฝะฝััยป

**ะงัะพ ััะพ:** ะะตะปััะธะพะฝะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั. ะะตััะพ, ะณะดะต ััะฐะฝะธััั ะฒัั ะธะฝัะพัะผะฐัะธั.

**ะงัะพ ััะฐะฝะธััั:**
- ะะพะปัะทะพะฒะฐัะตะปะธ ะธ ะธั ัะพะปะธ
- ะะตัะฐะดะฐะฝะฝัะต ะดะพะบัะผะตะฝัะพะฒ
- ะััะพัะธั ะดะตะนััะฒะธะน (ะฐัะดะธั)
- ะฃะฒะตะดะพะผะปะตะฝะธั
- ะะฐัััะพะนะบะธ ัะธััะตะผั

**ะะฐะถะฝะพ:** PostgreSQL ััะฐะฝะธั ะะะขะะะะะะซะ (ะธะฝัะพัะผะฐัะธั ะพ ะดะพะบัะผะตะฝัะฐั), ะฐ ะฝะต ัะฐะผะธ ะดะพะบัะผะตะฝัั. ะะพะบัะผะตะฝัั ััะฐะฝัััั ะฒ Timeweb KB.

```mermaid
erDiagram
    users {
        int id PK
        string username
        string role
        string brand_id
    }
    
    documents {
        int id PK
        string filename
        string category
        int uploaded_by FK
        datetime created_at
    }
    
    audit_log {
        int id PK
        int user_id FK
        string action
        datetime timestamp
    }
    
    notifications {
        int id PK
        int user_id FK
        string message
        boolean is_read
    }
    
    users ||--o{ documents : "ะทะฐะณััะถะฐะตั"
    users ||--o{ audit_log : "ัะพะฒะตััะฐะตั ะดะตะนััะฒะธั"
    users ||--o{ notifications : "ะฟะพะปััะฐะตั"
```

#### ๐ฎ Redis โ ยซะัะตัะตะดั ะทะฐะดะฐัยป

**ะงัะพ ััะพ:** ะััััะพะต ััะฐะฝะธะปะธัะต ะฒ ะฟะฐะผััะธ. ะัะฟะพะปัะทัะตััั ะบะฐะบ ยซะดะพัะบะฐ ัะพ ััะธะบะตัะฐะผะธยป ะดะปั ะทะฐะดะฐั.

**ะะฐัะตะผ ะฝัะถะตะฝ:**

ะะตะบะพัะพััะต ะทะฐะดะฐัะธ ะฝะตะปัะทั ะฒัะฟะพะปะฝะธัั ะผะณะฝะพะฒะตะฝะฝะพ:
- ะัะฟัะฐะฒะธัั email โ ะทะฐะฝะธะผะฐะตั 2-3 ัะตะบัะฝะดั
- ะะฑัะฐะฑะพัะฐัั ะฑะพะปััะพะน ัะฐะนะป โ ะทะฐะฝะธะผะฐะตั ะผะธะฝััั
- ะัะพะฒะตัะธัั ะทะดะพัะพะฒัะต ัะตัะฒะธัะพะฒ โ ะฝัะถะฝะพ ะดะตะปะฐัั ัะตะณัะปััะฝะพ

ะัะปะธ ะถะดะฐัั ะฒัะฟะพะปะฝะตะฝะธั, ะฟะพะปัะทะพะฒะฐัะตะปั ะฑัะดะตั ะฒะธะดะตัั ยซะทะฐะณััะทะบัยป. ะะพััะพะผั ะผั ะบะปะฐะดัะผ ะทะฐะดะฐัั ะฒ ะพัะตัะตะดั ะธ ััะฐะทั ะพัะฒะตัะฐะตะผ ะฟะพะปัะทะพะฒะฐัะตะปั.

```mermaid
sequenceDiagram
    participant U as ๐ค ะะพะปัะทะพะฒะฐัะตะปั
    participant MW as โ๏ธ Middleware
    participant R as ๐ฎ Redis
    participant C as โฐ Celery
    
    U->>MW: ะะฐะณััะทะธัั ัะฐะนะป
    MW->>R: ะะฐะดะฐัะฐ: ะพะฑัะฐะฑะพัะฐัั ัะฐะนะป
    MW-->>U: "ะคะฐะนะป ะฟัะธะฝัั!" (ะผะณะฝะพะฒะตะฝะฝะพ)
    
    Note over R,C: ะะพะทะถะต, ะฒ ัะพะฝะต...
    
    R->>C: ะะพั ะทะฐะดะฐัะฐ
    C->>C: ะะฑัะฐะฑะพัะบะฐ ัะฐะนะปะฐ (1 ะผะธะฝ)
    C->>U: ๐ ะฃะฒะตะดะพะผะปะตะฝะธะต: "ะคะฐะนะป ะพะฑัะฐะฑะพัะฐะฝ"
```

#### โฐ Celery โ ยซะะฐะฑะพัะฝะธะบ ะฝะฐ ะทะฐะดะฝะตะผ ะฟะปะฐะฝะตยป

**ะงัะพ ััะพ:** ะกะธััะตะผะฐ ะดะปั ะฒัะฟะพะปะฝะตะฝะธั ัะพะฝะพะฒัั ะทะฐะดะฐั.

**ะะฐะบะธะต ะทะฐะดะฐัะธ ะฒัะฟะพะปะฝัะตั:**
- ะัะฟัะฐะฒะบะฐ ัะฒะตะดะพะผะปะตะฝะธะน
- ะัะธััะบะฐ ััะฐััั ะดะฐะฝะฝัั
- ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั ัะตัะฒะธัะพะฒ
- ะะตัะธะพะดะธัะตัะบะธะต ะพััััั

**ะัะธะผะตั ะทะฐะดะฐั:**

| ะะฐะดะฐัะฐ | ะะพะณะดะฐ ะฒัะฟะพะปะฝัะตััั | ะงัะพ ะดะตะปะฐะตั |
|--------|-------------------|------------|
| `send_notification` | ะะพะณะดะฐ ะฟะพัะฒะธะปัั ะฝะพะฒัะน ะพัะทัะฒ | ะัะฟัะฐะฒะปัะตั popup ะผะตะฝะตะดะถะตัั |
| `cleanup_old_data` | ะะฐะถะดัั ะฝะพัั ะฒ 3:00 | ะฃะดะฐะปัะตั ััะฐััะต ะปะพะณะธ |
| `health_check` | ะะฐะถะดัะต 5 ะผะธะฝัั | ะัะพะฒะตััะตั ััะพ ะฒัั ัะฐะฑะพัะฐะตั |

---

## 3. ะะฐะบ ะบะพะผะฟะพะฝะตะฝัั ะพะฑัะฐัััั ะผะตะถะดั ัะพะฑะพะน

### 3.1 ะัะพัะพะบะพะปั ะพะฑัะตะฝะธั

**ะัะพัะพะบะพะป** โ ััะพ ยซัะทัะบยป, ะฝะฐ ะบะพัะพัะพะผ ะบะพะผะฟะพะฝะตะฝัั ัะฐะทะณะพะฒะฐัะธะฒะฐัั ะดััะณ ั ะดััะณะพะผ.

| ะัะบัะดะฐ โ ะัะดะฐ | ะัะพัะพะบะพะป | ะัะธะผะตั |
|---------------|----------|--------|
| ะัะฐัะทะตั โ Nginx | HTTPS | `GET https://adolf.su/` |
| Nginx โ Open WebUI | HTTP | `GET http://open-webui:8080/` |
| Open WebUI โ Middleware | HTTP | `POST http://middleware:8000/v1/chat` |
| Middleware โ Timeweb AI | HTTPS | `POST https://api.timeweb.cloud/v1/...` |
| Middleware โ PostgreSQL | TCP | `SELECT * FROM users` |
| Middleware โ Redis | TCP | `PUBLISH notifications {...}` |
| Redis โ Celery | TCP | ะะตัะตะดะฐัะฐ ะทะฐะดะฐัะธ |

### 3.2 ะกะธะฝััะพะฝะฝัะต vs ะัะธะฝััะพะฝะฝัะต ะทะฐะฟัะพัั

**ะกะธะฝััะพะฝะฝัะน ะทะฐะฟัะพั** โ ัั ะถะดััั ะพัะฒะตัะฐ ะฟััะผะพ ัะตะนัะฐั.
```
ะขั: "ะัะธะฒะตั, ะบะฐะบะธะต ัะฐะทะผะตัั ะตััั?"
[ะถะดััั 2 ัะตะบัะฝะดั]
AI: "ะะฐะทะผะตัั: S, M, L, XL"
```

**ะัะธะฝััะพะฝะฝัะน ะทะฐะฟัะพั** โ ัั ะฝะต ะถะดััั, ะพัะฒะตั ะฟัะธะดัั ะฟะพัะพะผ.
```
ะขั: "ะะฐะณััะทะธ ััะพั ัะฐะนะป"
ะกะธััะตะผะฐ: "ะัะธะฝััะพ!" (ะผะณะฝะพะฒะตะฝะฝะพ)
[ัะตัะตะท 1 ะผะธะฝััั]
๐ ะฃะฒะตะดะพะผะปะตะฝะธะต: "ะคะฐะนะป ะพะฑัะฐะฑะพัะฐะฝ"
```

```mermaid
flowchart LR
    subgraph SYNC["ะกะธะฝััะพะฝะฝัะต ะพะฟะตัะฐัะธะธ"]
        S1["ะัะฟัะฐะฒะธัั ัะพะพะฑัะตะฝะธะต ะฒ ัะฐั"]
        S2["ะะพะปััะธัั ัะฟะธัะพะบ ะพัะทัะฒะพะฒ"]
        S3["ะัะพะฒะตัะธัั ะฟัะฐะฒะฐ ะดะพัััะฟะฐ"]
    end
    
    subgraph ASYNC["ะัะธะฝััะพะฝะฝัะต ะพะฟะตัะฐัะธะธ"]
        A1["ะะฑัะฐะฑะพัะฐัั PDF-ัะฐะนะป"]
        A2["ะัะฟัะฐะฒะธัั ัะฒะตะดะพะผะปะตะฝะธะต"]
        A3["ะัะธััะธัั ััะฐััะต ะปะพะณะธ"]
    end
```

### 3.3 ะัะธะผะตั ะฟะพะปะฝะพะณะพ ะฟััะธ ะทะฐะฟัะพัะฐ

ะะฐะทะฑะตััะผ ััะพ ะฟัะพะธััะพะดะธั, ะบะพะณะดะฐ ะผะตะฝะตะดะถะตั ัะฟัะฐัะธะฒะฐะตั: **ยซะะฐะบะธะต ะพัะทัะฒั ะฟัะธัะปะธ ัะตะณะพะดะฝั?ยป**

```mermaid
sequenceDiagram
    autonumber
    
    participant B as ๐ ะัะฐัะทะตั
    participant N as ๐ช Nginx
    participant O as ๐ฌ Open WebUI
    participant M as โ๏ธ Middleware
    participant P as ๐๏ธ PostgreSQL
    participant T as ๐ค Timeweb AI
    
    B->>N: HTTPS ะทะฐะฟัะพั
    Note over N: SSL ัะฐััะธััะพะฒะบะฐ
    N->>O: HTTP ะทะฐะฟัะพั
    
    O->>M: POST /v1/chat/completions<br/>{"message": "ะะฐะบะธะต ะพัะทัะฒั..."}
    
    Note over M: ะัะพะฒะตัะบะฐ ะฐะฒัะพัะธะทะฐัะธะธ
    M->>P: SELECT role, brand_id FROM users
    P-->>M: role=manager, brand=ohana
    
    Note over M: ะคะพัะผะธัะพะฒะฐะฝะธะต ะทะฐะฟัะพัะฐ ะบ AI
    M->>T: ะะฐะฟัะพั + ัะธััะตะผะฝัะน ะฟัะพะผะฟั<br/>+ ัะธะปัััั (brand=ohana)
    
    Note over T: AI ะพะฑัะฐะฑะฐััะฒะฐะตั ะทะฐะฟัะพั
    T-->>M: "ะกะตะณะพะดะฝั 5 ะพัะทัะฒะพะฒ..."
    
    Note over M: ะะพะณะธัะพะฒะฐะฝะธะต
    M->>P: INSERT INTO audit_log...
    
    M-->>O: {"response": "ะกะตะณะพะดะฝั 5 ะพัะทัะฒะพะฒ..."}
    O-->>N: HTTP ะพัะฒะตั
    N-->>B: HTTPS ะพัะฒะตั
    
    Note over B: ะะพะปัะทะพะฒะฐัะตะปั ะฒะธะดะธั ะพัะฒะตั
```

**ะะพัะฐะณะพะฒะพะต ะพะฑัััะฝะตะฝะธะต:**

1. **ะัะฐัะทะตั โ Nginx:** ะะพะปัะทะพะฒะฐัะตะปั ะฝะฐะถะฐะป Enter, ะฑัะฐัะทะตั ะพัะฟัะฐะฒะธะป ะทะฐัะธััะพะฒะฐะฝะฝัะน ะทะฐะฟัะพั
2. **Nginx:** ะะฐััะธััะพะฒะฐะป HTTPS, ะฟะพะฝัะป ััะพ ััะพ ะทะฐะฟัะพั ะบ ัะฐัั, ะพัะฟัะฐะฒะธะป ะฒ Open WebUI
3. **Open WebUI โ Middleware:** ะะตัะตัะปะฐะป ัะพะพะฑัะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ API
4. **Middleware โ PostgreSQL:** ยซะัะพ ััะพ? ะงัะพ ะตะผั ะผะพะถะฝะพ?ยป โ ะทะฐะฟัะพั ะธะฝัะพัะผะฐัะธะธ ะพ ะฟะพะปัะทะพะฒะฐัะตะปะต
5. **Middleware:** ะะพะปััะธะป ะพัะฒะตั โ ััะพ ะผะตะฝะตะดะถะตั ะฑัะตะฝะดะฐ ยซะัะฐะฝะฐยป
6. **Middleware โ Timeweb AI:** ะัะฟัะฐะฒะธะป ะทะฐะฟัะพั ั ัะธะปัััะฐะผะธ (ัะพะปัะบะพ ะดะฐะฝะฝัะต ะัะฐะฝั)
7. **Timeweb AI:** ะะฑัะฐะฑะพัะฐะป ะทะฐะฟัะพั, ะฝะฐััะป ะธะฝัะพัะผะฐัะธั
8. **Middleware โ PostgreSQL:** ะะฐะฟะธัะฐะป ะฒ ะปะพะณ โ ยซะฟะพะปัะทะพะฒะฐัะตะปั X ัะฟัะพัะธะป ะฟัะพ ะพัะทัะฒัยป
9. **ะะฑัะฐัะฝัะน ะฟััั:** ะัะฒะตั ะธะดัั ะฝะฐะทะฐะด ะฟะพ ัะตะฟะพัะบะต

---

## 4. ะะพะปะธ ะธ ะฟัะฐะฒะฐ ะดะพัััะฟะฐ

### 4.1 ะะตัะฐััะธั ัะพะปะตะน

ะ ัะธััะตะผะต 5 ัะพะปะตะน. ะะฐะถะดะฐั ัะปะตะดัััะฐั ัะพะปั ะธะผะตะตั ะะกะ ะฟัะฐะฒะฐ ะฟัะตะดัะดััะตะน + ะดะพะฟะพะปะฝะธัะตะปัะฝัะต.

```mermaid
graph TB
    subgraph ROLES["ะะตัะฐััะธั ัะพะปะตะน"]
        ADMIN["๐ Administrator<br/>(ะฒัั)"]
        DIR["๐ Director<br/>(ัะธะฝะฐะฝัั + ะฒัั ะฝะธะถะต)"]
        SENIOR["๐ Senior Manager<br/>(ะผะพะดะตัะฐัะธั + ะฒัั ะฝะธะถะต)"]
        MANAGER["๐ค Manager<br/>(ะพัะทัะฒั, ัะตะฝั + ะฒัั ะฝะธะถะต)"]
        STAFF["๐ถ Staff<br/>(ัะพะปัะบะพ ัะฐั)"]
    end
    
    ADMIN --> DIR
    DIR --> SENIOR
    SENIOR --> MANAGER
    MANAGER --> STAFF
```

### 4.2 ะงัะพ ะผะพะถะตั ะบะฐะถะดะฐั ัะพะปั

| ะะตะนััะฒะธะต | Staff | Manager | Senior | Director | Admin |
|----------|-------|---------|--------|----------|-------|
| ะงะฐั ั AI | โ | โ | โ | โ | โ |
| ะะฐะณััะทะธัั ะดะพะบัะผะตะฝั | โ | โ | โ | โ | โ |
| ะะฐะฑะพัะฐ ั ะพัะทัะฒะฐะผะธ | โ | โ | โ | โ | โ |
| ะะพะฝะธัะพัะธะฝะณ ัะตะฝ | โ | โ | โ | โ | โ |
| ะะพะดะตัะฐัะธั ะดะพะบัะผะตะฝัะพะฒ | โ | โ | โ | โ | โ |
| ะคะธะฝะฐะฝัะพะฒัะต ะพััััั | โ | โ | โ | โ | โ |
| ะะฐัััะพะนะบะธ ัะธััะตะผั | โ | โ | โ | โ | โ |

### 4.3 ะคะธะปัััะฐัะธั ะฟะพ ะฑัะตะฝะดะฐะผ

ะะพะผะฟะฐะฝะธั ัะฟัะฐะฒะปัะตั ะฝะตัะบะพะปัะบะธะผะธ ะฑัะตะฝะดะฐะผะธ ะฝะฐ ะผะฐัะบะตัะฟะปะตะนัะฐั. ะะฐะถะดัะน ะผะตะฝะตะดะถะตั ะฒะธะดะธั ัะพะปัะบะพ ยซัะฒะพะธยป ะดะฐะฝะฝัะต.

```mermaid
flowchart TB
    subgraph COMPANY["๐ข ะะพะผะฟะฐะฝะธั"]
        subgraph B1["ะัะตะฝะด: ะัะฐะฝะฐ ะะฐัะบะตั"]
            M1["ะะตะฝะตะดะถะตั ะะฝะฝะฐ"]
            M2["ะะตะฝะตะดะถะตั ะะพัะธั"]
            D1["๐ ะะพะบัะผะตะฝัั ะัะฐะฝั"]
            R1["โญ ะัะทัะฒั ะัะฐะฝั"]
        end
        
        subgraph B2["ะัะตะฝะด: ะะพัะพะดะพะบ"]
            M3["ะะตะฝะตะดะถะตั ะะตัะฐ"]
            D2["๐ ะะพะบัะผะตะฝัั ะะพัะพะดะบะฐ"]
            R2["โญ ะัะทัะฒั ะะพัะพะดะบะฐ"]
        end
        
        subgraph SENIOR_LEVEL["Senior Manager +"]
            SM["Senior Manager<br/>(ะฒะธะดะธั ะะกะ ะฑัะตะฝะดั)"]
        end
    end
    
    M1 & M2 --> D1 & R1
    M3 --> D2 & R2
    SM --> D1 & R1 & D2 & R2
```

**ะะฐะบ ััะพ ัะฐะฑะพัะฐะตั ัะตัะฝะธัะตัะบะธ:**

```python
# Middleware ะดะพะฑะฐะฒะปัะตั ัะธะปััั ะฒ ะทะฐะฟัะพั ะบ AI

def add_brand_filter(user, request):
    if user.role == "manager":
        # ะะตะฝะตะดะถะตั ะฒะธะดะธั ัะพะปัะบะพ ัะฒะพะน ะฑัะตะฝะด
        request.filters["brand_id"] = user.brand_id
    elif user.role in ("senior_manager", "director", "administrator"):
        # ะกัะฐััะธะต ัะพะปะธ ะฒะธะดัั ะฒัั
        request.filters["brand_id"] = None  # ะฑะตะท ัะธะปัััะฐ
    
    return request
```

---

## 5. ะะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ (ETL)

### 5.1 ะััั ะดะพะบัะผะตะฝัะฐ

ะะพะณะดะฐ ะผะตะฝะตะดะถะตั ะทะฐะณััะถะฐะตั ัะฐะนะป, ะพะฝ ะฟัะพัะพะดะธั ะฝะตัะบะพะปัะบะพ ััะฐะฟะพะฒ:

```mermaid
flowchart TB
    subgraph UPLOAD["1๏ธโฃ ะะฐะณััะทะบะฐ"]
        U["๐ค ะะตะฝะตะดะถะตั"]
        OWUI["๐ฌ Open WebUI"]
        INBOX["๐ฅ /inbox"]
    end
    
    subgraph PROCESS["2๏ธโฃ ะะฑัะฐะฑะพัะบะฐ"]
        WATCH["๐ Watchdog<br/>(ะทะฐะผะตัะธะป ัะฐะนะป)"]
        DETECT["๐ ะะฟัะตะดะตะปะตะฝะธะต ัะธะฟะฐ"]
        CONV["๐ ะะพะฝะฒะตััะฐัะธั ะฒ .md"]
        OCR["๐๏ธ OCR<br/>(ะตัะปะธ ัะบะฐะฝ)"]
    end
    
    subgraph CLASSIFY["3๏ธโฃ ะะปะฐััะธัะธะบะฐัะธั"]
        AI["๐ค GPT-5 mini"]
        META["๐ ะะตัะฐะดะฐะฝะฝัะต:<br/>category, access_level, brand_id"]
    end
    
    subgraph MODERATE["4๏ธโฃ ะะพะดะตัะฐัะธั"]
        SENIOR["๐ Senior Manager"]
        APPROVE["โ ะะดะพะฑัะธัั"]
        REJECT["โ ะัะบะปะพะฝะธัั"]
    end
    
    subgraph FINISH["5๏ธโฃ ะะฐะฒะตััะตะฝะธะต"]
        KB["๐ ะะฐะทะฐ ะทะฝะฐะฝะธะน"]
        ARCH["๐ฆ ะััะธะฒ"]
        NOTIFY["๐ ะฃะฒะตะดะพะผะปะตะฝะธะต"]
    end
    
    U -->|ะทะฐะณััะถะฐะตั| OWUI
    OWUI -->|ัะพััะฐะฝัะตั| INBOX
    INBOX --> WATCH
    WATCH --> DETECT
    DETECT --> CONV
    CONV -.->|ะตัะปะธ ะฝัะถะตะฝ| OCR
    OCR --> CONV
    CONV --> AI
    AI --> META
    META --> SENIOR
    SENIOR --> APPROVE
    SENIOR --> REJECT
    APPROVE --> KB
    KB --> ARCH
    ARCH --> NOTIFY
    REJECT --> NOTIFY
```

### 5.2 ะะฒัะพะบะปะฐััะธัะธะบะฐัะธั

AI ะฐะฒัะพะผะฐัะธัะตัะบะธ ะพะฟัะตะดะตะปัะตั:

| ะะฐัะฐะผะตัั | ะงัะพ ะพะทะฝะฐัะฐะตั | ะัะธะผะตัั ะทะฝะฐัะตะฝะธะน |
|----------|--------------|------------------|
| `category` | ะขะธะฟ ะดะพะบัะผะตะฝัะฐ | product, instruction, legal, finance |
| `access_level` | ะัะพ ะผะพะถะตั ะฒะธะดะตัั | staff, manager, senior_manager, director |
| `brand_id` | ะะฐะบะพะน ะฑัะตะฝะด | ohana_market, gorodok, all |

**ะัะธะผะตั ะฟัะพะผะฟัะฐ ะดะปั ะบะปะฐััะธัะธะบะฐัะธะธ:**

```
ะัะพะฐะฝะฐะปะธะทะธััะน ะดะพะบัะผะตะฝั ะธ ะพะฟัะตะดะตะปะธ:
1. ะะฐัะตะณะพัะธั (product/instruction/legal/finance/other)
2. ะฃัะพะฒะตะฝั ะดะพัััะฟะฐ (staff/manager/senior_manager/director)
3. ะัะตะฝะด (ohana_market/gorodok/all)

ะะพะบัะผะตะฝั:
---
ะะฐะทะผะตัะฝะฐั ัะตัะบะฐ ะดะปั ััะดะธ ะพะฒะตััะฐะนะท
ะัะตะฝะด: ะัะฐะฝะฐ ะะฐัะบะตั
ะััะธะบัะป: 12345
...
---

ะัะฒะตัั ะฒ ัะพัะผะฐัะต JSON:
{"category": "...", "access_level": "...", "brand_id": "..."}
```

### 5.3 ะะพะดะตัะฐัะธั

ะะพะบัะผะตะฝั ะฝะต ะฟะพะฟะฐะดะฐะตั ะฒ ะฑะฐะทั ะทะฝะฐะฝะธะน ััะฐะทั. ะกะฝะฐัะฐะปะฐ ะตะณะพ ะดะพะปะถะตะฝ ะพะดะพะฑัะธัั Senior Manager.

```mermaid
stateDiagram-v2
    [*] --> uploaded: ะคะฐะนะป ะทะฐะณััะถะตะฝ
    uploaded --> processing: ETL ะฝะฐัะฐะป ะพะฑัะฐะฑะพัะบั
    processing --> pending: ะะปะฐััะธัะธะบะฐัะธั ะทะฐะฒะตััะตะฝะฐ
    pending --> approved: Senior ะพะดะพะฑัะธะป โ
    pending --> rejected: Senior ะพัะบะปะพะฝะธะป โ
    approved --> indexed: ะะพะฑะฐะฒะปะตะฝ ะฒ KB
    indexed --> [*]
    rejected --> [*]
```

**ะะฐัะตะผ ะฝัะถะฝะฐ ะผะพะดะตัะฐัะธั:**
- ะัะพะฒะตัะธัั ััะพ AI ะฟัะฐะฒะธะปัะฝะพ ะบะปะฐััะธัะธัะธัะพะฒะฐะป
- ะฃะฑะตะดะธัััั ััะพ ะดะพะบัะผะตะฝั ะฝะต ัะพะดะตัะถะธั ะพัะธะฑะพะบ
- ะะฐัะธัะธัั ะฑะฐะทั ะทะฝะฐะฝะธะน ะพั ะผััะพัะฐ

---

## 6. ะกะธััะตะผะฐ ัะฒะตะดะพะผะปะตะฝะธะน

### 6.1 ะะฐะบ ัะฐะฑะพัะฐัั ัะฒะตะดะพะผะปะตะฝะธั

```mermaid
flowchart LR
    subgraph SOURCES["๐ข ะััะพัะฝะธะบะธ ัะพะฑััะธะน"]
        REP["โญ ะะพะฒัะน ะพัะทัะฒ"]
        DOC["๐ ะะพะบัะผะตะฝั ะฝะฐ ะผะพะดะตัะฐัะธั"]
        PRICE["๐ฐ ะะตะผะฟะธะฝะณ-ะฐะปะตัั"]
        SYS["โ๏ธ ะัะธะฑะบะฐ ัะธััะตะผั"]
    end
    
    subgraph BUS["๐ Event Bus"]
        REDIS["Redis Pub/Sub"]
    end
    
    subgraph DELIVERY["๐ฌ ะะพััะฐะฒะบะฐ"]
        WS["WebSocket"]
        DB["PostgreSQL"]
    end
    
    subgraph UI["๐ ะะฝัะตััะตะนั"]
        COUNTER["๐ข ะกััััะธะบ ะฒ ะผะตะฝั"]
        POPUP["๐ฌ Popup"]
    end
    
    REP & DOC & PRICE & SYS --> REDIS
    REDIS --> WS
    REDIS --> DB
    WS --> COUNTER
    WS --> POPUP
```

### 6.2 ะขะธะฟั ัะฒะตะดะพะผะปะตะฝะธะน

| ะฃัะพะฒะตะฝั | ะะบะพะฝะบะฐ | ะะฐะบ ะฟะพะบะฐะทัะฒะฐะตััั | ะัะธะผะตั |
|---------|--------|------------------|--------|
| `info` | โน๏ธ | ะขะพะปัะบะพ ัััััะธะบ | ะะพะฒัะน ะพัะทัะฒ 5โญ |
| `warning` | โ๏ธ | ะกััััะธะบ + popup | ะะตะณะฐัะธะฒะฝัะน ะพัะทัะฒ 2โญ |
| `critical` | ๐ด | Popup + ะทะฒัะบ | ะกะตัะฒะธั ะฝะตะดะพัััะฟะตะฝ |

### 6.3 ะัะพ ะฟะพะปััะฐะตั ัะฒะตะดะพะผะปะตะฝะธั

```mermaid
flowchart TB
    subgraph EVENTS["ะกะพะฑััะธั"]
        E1["โญ ะะพะฒัะน ะพัะทัะฒ<br/>(ะฑัะตะฝะด: ะัะฐะฝะฐ)"]
        E2["๐ ะะพะบัะผะตะฝั ะฝะฐ ะผะพะดะตัะฐัะธั"]
        E3["โ๏ธ ะัะธะฑะบะฐ ัะธััะตะผั"]
    end
    
    subgraph ROUTER["ะะฐัััััะธะทะฐัะพั"]
        R["ะัะฐะฒะธะปะฐ ะผะฐัััััะธะทะฐัะธะธ"]
    end
    
    subgraph USERS["ะะพะปััะฐัะตะปะธ"]
        U1["๐ค ะะตะฝะตะดะถะตั ะัะฐะฝั"]
        U2["๐ Senior Manager"]
        U3["๐ Administrator"]
    end
    
    E1 --> R
    E2 --> R
    E3 --> R
    
    R -->|ะฟะพ ะฑัะตะฝะดั| U1
    R -->|ะฟะพ ัะพะปะธ| U2
    R -->|critical| U3
```

---

## 7. ะะตะทะพะฟะฐัะฝะพััั

### 7.1 ะกะปะพะธ ะทะฐัะธัั

```mermaid
flowchart TB
    subgraph L1["๐ ะกะปะพะน 1: ะกะตัั"]
        HTTPS["HTTPS (ัะธััะพะฒะฐะฝะธะต)"]
        FW["Firewall (ัะพะปัะบะพ 80, 443)"]
    end
    
    subgraph L2["๐ ะกะปะพะน 2: ะะฒัะพัะธะทะฐัะธั"]
        LOGIN["ะะพะณะธะฝ + ะฟะฐัะพะปั"]
        JWT["JWT ัะพะบะตะฝ"]
        SESSION["ะกะตััะธั"]
    end
    
    subgraph L3["๐ก๏ธ ะกะปะพะน 3: ะัะฐะฒะฐ"]
        ROLE["ะัะพะฒะตัะบะฐ ัะพะปะธ"]
        BRAND["ะัะพะฒะตัะบะฐ ะฑัะตะฝะดะฐ"]
        FILTER["ะคะธะปัััะฐัะธั ะดะฐะฝะฝัั"]
    end
    
    subgraph L4["๐ ะกะปะพะน 4: ะัะดะธั"]
        LOG["ะะพะณะธัะพะฒะฐะฝะธะต ะดะตะนััะฒะธะน"]
        ALERT["ะะปะตััั ะฝะฐ ะฟะพะดะพะทัะธัะตะปัะฝะพะต"]
    end
    
    L1 --> L2 --> L3 --> L4
```

### 7.2 ะงัะพ ะปะพะณะธััะตััั

ะะฐะถะดะพะต ะดะตะนััะฒะธะต ะทะฐะฟะธััะฒะฐะตััั ะฒ `audit_log`:

| ะะพะปะต | ะัะธะผะตั | ะะฐัะตะผ |
|------|--------|-------|
| `user_id` | 42 | ะัะพ ัะดะตะปะฐะป |
| `action` | `document.upload` | ะงัะพ ัะดะตะปะฐะป |
| `resource` | `document:123` | ะก ัะตะผ ัะดะตะปะฐะป |
| `ip_address` | `192.168.1.100` | ะัะบัะดะฐ ัะดะตะปะฐะป |
| `timestamp` | `2026-01-15 14:30:00` | ะะพะณะดะฐ ัะดะตะปะฐะป |
| `details` | `{"filename": "sizes.xlsx"}` | ะะตัะฐะปะธ |

---

## 8. ะงัะพ ะฒะฐะถะฝะพ ะฟะพะผะฝะธัั

### 8.1 ะะปััะตะฒัะต ะฟัะธะฝัะธะฟั

1. **ะะฐะทะดะตะปะตะฝะธะต ะพัะฒะตัััะฒะตะฝะฝะพััะธ**
   - ะะฐะถะดัะน ะบะพะผะฟะพะฝะตะฝั ะดะตะปะฐะตั ััะพ-ัะพ ะพะดะฝะพ
   - Nginx โ ะฟัะธะฝะธะผะฐะตั ะทะฐะฟัะพัั
   - Middleware โ ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ
   - ETL โ ะพะฑัะฐะฑะพัะบะฐ ัะฐะนะปะพะฒ
   - ะ ัะฐะบ ะดะฐะปะตะต

2. **Stateless (ะฑะตะท ัะพััะพัะฝะธั)**
   - Middleware ะฝะต ััะฐะฝะธั ะดะฐะฝะฝัะต ะผะตะถะดั ะทะฐะฟัะพัะฐะผะธ
   - ะัั ัะพััะพัะฝะธะต โ ะฒ PostgreSQL ะธ Redis
   - ะะพะถะฝะพ ะทะฐะฟัััะธัั ะฝะตัะบะพะปัะบะพ ะบะพะฟะธะน Middleware

3. **ะัะธะฝััะพะฝะฝะพััั ะดะปั ััะถัะปัั ะทะฐะดะฐั**
   - ะัั ััะพ ะดะพะปััะต 1 ัะตะบัะฝะดั โ ะฒ Celery
   - ะะพะปัะทะพะฒะฐัะตะปั ะฝะต ะดะพะปะถะตะฝ ะถะดะฐัั

4. **ะะตะทะพะฟะฐัะฝะพััั ะฟะพ ัะผะพะปัะฐะฝะธั**
   - ะัั ะทะฐะฟัะตัะตะฝะพ, ะฟะพะบะฐ ัะฒะฝะพ ะฝะต ัะฐะทัะตัะตะฝะพ
   - ะะฐะถะดัะน ะทะฐะฟัะพั ะฟัะพะฒะตััะตััั
   - ะัะต ะดะตะนััะฒะธั ะปะพะณะธัััััั

### 8.2 ะงะฐัััะต ะฒะพะฟัะพัั ะฝะพะฒะธัะบะพะฒ

**Q: ะะพัะตะผั Open WebUI, ะฐ ะฝะต ัะฒะพะน ะธะฝัะตััะตะนั?**
A: Open WebUI โ ะณะพัะพะฒะพะต ัะตัะตะฝะธะต. ะะธัะฐัั ัะฒะพะน ัะฐั ั ะฝัะปั โ 2-3 ะผะตัััะฐ. Open WebUI โ 2 ะฝะตะดะตะปะธ ะฝะฐ ะฝะฐัััะพะนะบั.

**Q: ะะพัะตะผั Timeweb AI, ะฐ ะฝะต OpenAI ะฝะฐะฟััะผัั?**
A: Timeweb AI ะฒะบะปััะฐะตั ะฑะฐะทั ะทะฝะฐะฝะธะน (KB) ั ะฒะตะบัะพัะฝัะผ ะฟะพะธัะบะพะผ. ะะต ะฝัะถะฝะพ ะฟะธัะฐัั RAG ัะฐะผะธะผ.

**Q: ะะฐัะตะผ Redis, ะตัะปะธ ะตััั PostgreSQL?**
A: PostgreSQL โ ะดะปั ะดะพะปะณะพะณะพ ััะฐะฝะตะฝะธั. Redis โ ะดะปั ะฑัััััั ะพะฟะตัะฐัะธะน (ะพัะตัะตะดะธ, ะบะตั). PostgreSQL ะผะตะดะปะตะฝะฝะตะต ะดะปั ัะฐะบะธั ะทะฐะดะฐั.

**Q: ะะพัะตะผั Celery, ะฐ ะฝะต ะฟัะพััะพ ะฟะพัะพะบะธ ะฒ Python?**
A: Celery ัะผะตะตั:
   - ะะฐัะฟัะตะดะตะปััั ะทะฐะดะฐัะธ ะผะตะถะดั ัะตัะฒะตัะฐะผะธ
   - ะะพะฒัะพัััั ัะฟะฐะฒัะธะต ะทะฐะดะฐัะธ
   - ะะปะฐะฝะธัะพะฒะฐัั ะทะฐะดะฐัะธ ะฟะพ ัะฐัะฟะธัะฐะฝะธั
   - ะะพะฝะธัะพัะธัั ััะพ ะฟัะพะธััะพะดะธั

**Q: ะงัะพ ะฑัะดะตั ะตัะปะธ ัะฟะฐะดัั ะพะดะธะฝ ะบะพะผะฟะพะฝะตะฝั?**
A: Docker Compose ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฟะตัะตะทะฐะฟัััะธั ะตะณะพ (`restart: unless-stopped`).

### 8.3 ะกะปะพะฒะฐัั ัะตัะผะธะฝะพะฒ

| ะขะตัะผะธะฝ | ะะฑัััะฝะตะฝะธะต |
|--------|------------|
| **API** | ะกะฟะพัะพะฑ ะดะปั ะฟัะพะณัะฐะผะผ ะพะฑัะฐัััั ะดััะณ ั ะดััะณะพะผ |
| **JWT** | ะขะพะบะตะฝ (ัััะพะบะฐ), ะฟะพะดัะฒะตัะถะดะฐััะธะน ััะพ ัั ะฐะฒัะพัะธะทะพะฒะฐะฝ |
| **Middleware** | ะัะพะณัะฐะผะผะฐ-ะฟะพััะตะดะฝะธะบ ะผะตะถะดั ะดะฒัะผั ะดััะณะธะผะธ |
| **ETL** | Extract-Transform-Load โ ะฟัะพัะตัั ะพะฑัะฐะฑะพัะบะธ ะดะฐะฝะฝัั |
| **RAG** | Retrieval-Augmented Generation โ AI + ะฟะพะธัะบ ะฟะพ ะดะพะบัะผะตะฝัะฐะผ |
| **WebSocket** | ะะพััะพัะฝะฝะพะต ัะพะตะดะธะฝะตะฝะธะต ะดะปั ะผะณะฝะพะฒะตะฝะฝัั ัะฒะตะดะพะผะปะตะฝะธะน |
| **Pub/Sub** | ะะฐััะตัะฝ: ะพะดะธะฝ ะฟัะฑะปะธะบัะตั ัะพะพะฑัะตะฝะธะต, ะผะฝะพะณะธะต ะฟะพะปััะฐัั |
| **Docker** | ะะฝััััะผะตะฝั ะดะปั ะทะฐะฟััะบะฐ ะฟัะธะปะพะถะตะฝะธะน ะฒ ะบะพะฝัะตะนะฝะตัะฐั |
| **ORM** | ะะธะฑะปะธะพัะตะบะฐ ะดะปั ัะฐะฑะพัั ั ะะ ัะตัะตะท Python-ะพะฑัะตะบัั |

---

## 9. ะกะปะตะดัััะธะต ัะฐะณะธ

ะะพัะปะต ะฟัะพััะตะฝะธั ััะพะณะพ ะดะพะบัะผะตะฝัะฐ ัะตะบะพะผะตะฝะดัะตััั:

1. **ะะทััะธัั ะบะพะฝะบัะตัะฝัะต ัะฐะทะดะตะปั:**
   - [ะะฐะทะดะตะป 2.1: ะััะธัะตะบัััะฐ](adolf_core_2_1_architecture.md) โ ะดะตัะฐะปะธ ัะตัะฒะตัะฝะพะน ัะฐััะธ
   - [ะะฐะทะดะตะป 2.2: Middleware](adolf_core_2_2_middleware.md) โ ะบะฐะบ ัะฐะฑะพัะฐะตั API
   - [ะะฐะทะดะตะป 2.3: ETL](adolf_core_2_3_etl.md) โ ะพะฑัะฐะฑะพัะบะฐ ะดะพะบัะผะตะฝัะพะฒ

2. **ะะพัะผะพััะตัั ะบะพะด:**
   - ะะฐัะฐัั ั `middleware/main.py` โ ัะพัะบะฐ ะฒัะพะดะฐ
   - ะะทััะธัั `middleware/api/` โ ัะฝะดะฟะพะธะฝัั API
   - ะะพัะผะพััะตัั `middleware/services/` โ ะฑะธะทะฝะตั-ะปะพะณะธะบะฐ

3. **ะะพะดะฝััั ะปะพะบะฐะปัะฝะพ:**
   - ะกะบะปะพะฝะธัะพะฒะฐัั ัะตะฟะพะทะธัะพัะธะน
   - ะะฐะฟัััะธัั `docker compose up`
   - ะะพะฟัะพะฑะพะฒะฐัั ะพัะฟัะฐะฒะธัั ะทะฐะฟัะพั

---

**ะะพะบัะผะตะฝั ะฟะพะดะณะพัะพะฒะปะตะฝ:** ะฏะฝะฒะฐัั 2026  
**ะะตััะธั:** 4.0  
**ะะปั:** Junior-ัะฐะทัะฐะฑะพััะธะบะธ, ะฝะพะฒัะต ััะฐััะฝะธะบะธ ะบะพะผะฐะฝะดั
